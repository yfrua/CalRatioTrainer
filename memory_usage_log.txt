2024-09-13 10:54:37,207 - root - INFO - Initializing the model
2024-09-13 10:54:37,207 - root - INFO - Initializing model default
2024-09-13 10:54:38,035 - root - INFO - Num GPUs Available: 4
2024-09-13 10:54:38,038 - root - DEBUG - Main directory for output: training_results/default/00011
2024-09-13 10:54:38,038 - root - DEBUG - Writing to file training details...
2024-09-13 10:54:38,039 - root - INFO - Loading control region data file https://cernbox.cern.ch/remote.php/dav/public-files/r0GQeSVMuu0mDKX/processed_output_controlRegion_corrected.pkl...
2024-09-13 10:54:47,665 - root - DEBUG -    label  mcEventWeight  ...  MSeg_chiSquared_29  MSeg_t0_29
0    2.0       1.000000  ...                 0.0         0.0
1    2.0       1.000000  ...                 0.0         0.0
2    2.0       1.000000  ...                 0.0         0.0
3    0.0       0.526294  ...                 0.0         0.0
4    0.0       1.020957  ...                 0.0         0.0

[5 rows x 819 columns]
2024-09-13 10:54:48,070 - root - INFO -   Length of Signal is: 0
2024-09-13 10:54:48,547 - root - INFO -   Length of QCD is: 223050
2024-09-13 10:54:49,048 - root - INFO -   Length of BIB is: 226127
2024-09-13 10:54:49,048 - root - DEBUG -   Column names for this data file: label, mcEventWeight, flatWeight, jet_pt, jet_eta, jet_phi, jet_logRatio, jet_nn_calRatio_main_qcd_lowMass_v3Adv, jet_nn_calRatio_main_sig_lowMass_v3Adv, jet_nn_calRatio_main_bib_lowMass_v3Adv, jet_nn_calRatio_main_qcd_highMass_v3Adv, jet_nn_calRatio_main_sig_highMass_v3Adv, jet_nn_calRatio_main_bib_highMass_v3Adv, jet_isClean_LooseBadLLP, data_year, JZ_num, jet_order, actualInteractionsPerCrossing, eventNumber, clus_pt_0, clus_eta_0, clus_phi_0, clus_l1hcal_0, clus_l1ecal_0, clus_l2hcal_0, clus_l2ecal_0, clus_l3hcal_0, clus_l3ecal_0, clus_l4ecal_0, clus_l4hcal_0, clus_time_0, clus_pt_1, clus_eta_1, clus_phi_1, clus_l1hcal_1, clus_l1ecal_1, clus_l2hcal_1, clus_l2ecal_1, clus_l3hcal_1, clus_l3ecal_1, clus_l4ecal_1, clus_l4hcal_1, clus_time_1, clus_pt_2, clus_eta_2, clus_phi_2, clus_l1hcal_2, clus_l1ecal_2, clus_l2hcal_2, clus_l2ecal_2, clus_l3hcal_2, clus_l3ecal_2, clus_l4ecal_2, clus_l4hcal_2, clus_time_2, clus_pt_3, clus_eta_3, clus_phi_3, clus_l1hcal_3, clus_l1ecal_3, clus_l2hcal_3, clus_l2ecal_3, clus_l3hcal_3, clus_l3ecal_3, clus_l4ecal_3, clus_l4hcal_3, clus_time_3, clus_pt_4, clus_eta_4, clus_phi_4, clus_l1hcal_4, clus_l1ecal_4, clus_l2hcal_4, clus_l2ecal_4, clus_l3hcal_4, clus_l3ecal_4, clus_l4ecal_4, clus_l4hcal_4, clus_time_4, clus_pt_5, clus_eta_5, clus_phi_5, clus_l1hcal_5, clus_l1ecal_5, clus_l2hcal_5, clus_l2ecal_5, clus_l3hcal_5, clus_l3ecal_5, clus_l4ecal_5, clus_l4hcal_5, clus_time_5, clus_pt_6, clus_eta_6, clus_phi_6, clus_l1hcal_6, clus_l1ecal_6, clus_l2hcal_6, clus_l2ecal_6, clus_l3hcal_6, clus_l3ecal_6, clus_l4ecal_6, clus_l4hcal_6, clus_time_6, clus_pt_7, clus_eta_7, clus_phi_7, clus_l1hcal_7, clus_l1ecal_7, clus_l2hcal_7, clus_l2ecal_7, clus_l3hcal_7, clus_l3ecal_7, clus_l4ecal_7, clus_l4hcal_7, clus_time_7, clus_pt_8, clus_eta_8, clus_phi_8, clus_l1hcal_8, clus_l1ecal_8, clus_l2hcal_8, clus_l2ecal_8, clus_l3hcal_8, clus_l3ecal_8, clus_l4ecal_8, clus_l4hcal_8, clus_time_8, clus_pt_9, clus_eta_9, clus_phi_9, clus_l1hcal_9, clus_l1ecal_9, clus_l2hcal_9, clus_l2ecal_9, clus_l3hcal_9, clus_l3ecal_9, clus_l4ecal_9, clus_l4hcal_9, clus_time_9, clus_pt_10, clus_eta_10, clus_phi_10, clus_l1hcal_10, clus_l1ecal_10, clus_l2hcal_10, clus_l2ecal_10, clus_l3hcal_10, clus_l3ecal_10, clus_l4ecal_10, clus_l4hcal_10, clus_time_10, clus_pt_11, clus_eta_11, clus_phi_11, clus_l1hcal_11, clus_l1ecal_11, clus_l2hcal_11, clus_l2ecal_11, clus_l3hcal_11, clus_l3ecal_11, clus_l4ecal_11, clus_l4hcal_11, clus_time_11, clus_pt_12, clus_eta_12, clus_phi_12, clus_l1hcal_12, clus_l1ecal_12, clus_l2hcal_12, clus_l2ecal_12, clus_l3hcal_12, clus_l3ecal_12, clus_l4ecal_12, clus_l4hcal_12, clus_time_12, clus_pt_13, clus_eta_13, clus_phi_13, clus_l1hcal_13, clus_l1ecal_13, clus_l2hcal_13, clus_l2ecal_13, clus_l3hcal_13, clus_l3ecal_13, clus_l4ecal_13, clus_l4hcal_13, clus_time_13, clus_pt_14, clus_eta_14, clus_phi_14, clus_l1hcal_14, clus_l1ecal_14, clus_l2hcal_14, clus_l2ecal_14, clus_l3hcal_14, clus_l3ecal_14, clus_l4ecal_14, clus_l4hcal_14, clus_time_14, clus_pt_15, clus_eta_15, clus_phi_15, clus_l1hcal_15, clus_l1ecal_15, clus_l2hcal_15, clus_l2ecal_15, clus_l3hcal_15, clus_l3ecal_15, clus_l4ecal_15, clus_l4hcal_15, clus_time_15, clus_pt_16, clus_eta_16, clus_phi_16, clus_l1hcal_16, clus_l1ecal_16, clus_l2hcal_16, clus_l2ecal_16, clus_l3hcal_16, clus_l3ecal_16, clus_l4ecal_16, clus_l4hcal_16, clus_time_16, clus_pt_17, clus_eta_17, clus_phi_17, clus_l1hcal_17, clus_l1ecal_17, clus_l2hcal_17, clus_l2ecal_17, clus_l3hcal_17, clus_l3ecal_17, clus_l4ecal_17, clus_l4hcal_17, clus_time_17, clus_pt_18, clus_eta_18, clus_phi_18, clus_l1hcal_18, clus_l1ecal_18, clus_l2hcal_18, clus_l2ecal_18, clus_l3hcal_18, clus_l3ecal_18, clus_l4ecal_18, clus_l4hcal_18, clus_time_18, clus_pt_19, clus_eta_19, clus_phi_19, clus_l1hcal_19, clus_l1ecal_19, clus_l2hcal_19, clus_l2ecal_19, clus_l3hcal_19, clus_l3ecal_19, clus_l4ecal_19, clus_l4hcal_19, clus_time_19, clus_pt_20, clus_eta_20, clus_phi_20, clus_l1hcal_20, clus_l1ecal_20, clus_l2hcal_20, clus_l2ecal_20, clus_l3hcal_20, clus_l3ecal_20, clus_l4ecal_20, clus_l4hcal_20, clus_time_20, clus_pt_21, clus_eta_21, clus_phi_21, clus_l1hcal_21, clus_l1ecal_21, clus_l2hcal_21, clus_l2ecal_21, clus_l3hcal_21, clus_l3ecal_21, clus_l4ecal_21, clus_l4hcal_21, clus_time_21, clus_pt_22, clus_eta_22, clus_phi_22, clus_l1hcal_22, clus_l1ecal_22, clus_l2hcal_22, clus_l2ecal_22, clus_l3hcal_22, clus_l3ecal_22, clus_l4ecal_22, clus_l4hcal_22, clus_time_22, clus_pt_23, clus_eta_23, clus_phi_23, clus_l1hcal_23, clus_l1ecal_23, clus_l2hcal_23, clus_l2ecal_23, clus_l3hcal_23, clus_l3ecal_23, clus_l4ecal_23, clus_l4hcal_23, clus_time_23, clus_pt_24, clus_eta_24, clus_phi_24, clus_l1hcal_24, clus_l1ecal_24, clus_l2hcal_24, clus_l2ecal_24, clus_l3hcal_24, clus_l3ecal_24, clus_l4ecal_24, clus_l4hcal_24, clus_time_24, clus_pt_25, clus_eta_25, clus_phi_25, clus_l1hcal_25, clus_l1ecal_25, clus_l2hcal_25, clus_l2ecal_25, clus_l3hcal_25, clus_l3ecal_25, clus_l4ecal_25, clus_l4hcal_25, clus_time_25, clus_pt_26, clus_eta_26, clus_phi_26, clus_l1hcal_26, clus_l1ecal_26, clus_l2hcal_26, clus_l2ecal_26, clus_l3hcal_26, clus_l3ecal_26, clus_l4ecal_26, clus_l4hcal_26, clus_time_26, clus_pt_27, clus_eta_27, clus_phi_27, clus_l1hcal_27, clus_l1ecal_27, clus_l2hcal_27, clus_l2ecal_27, clus_l3hcal_27, clus_l3ecal_27, clus_l4ecal_27, clus_l4hcal_27, clus_time_27, clus_pt_28, clus_eta_28, clus_phi_28, clus_l1hcal_28, clus_l1ecal_28, clus_l2hcal_28, clus_l2ecal_28, clus_l3hcal_28, clus_l3ecal_28, clus_l4ecal_28, clus_l4hcal_28, clus_time_28, clus_pt_29, clus_eta_29, clus_phi_29, clus_l1hcal_29, clus_l1ecal_29, clus_l2hcal_29, clus_l2ecal_29, clus_l3hcal_29, clus_l3ecal_29, clus_l4ecal_29, clus_l4hcal_29, clus_time_29, track_pt_0, track_eta_0, track_phi_0, track_vertex_nParticles_0, track_d0_0, track_z0_0, track_chiSquared_0, track_PixelShared_0, track_SCTShared_0, track_PixelHoles_0, track_SCTHoles_0, track_PixelHits_0, track_SCTHits_0, track_pt_1, track_eta_1, track_phi_1, track_vertex_nParticles_1, track_d0_1, track_z0_1, track_chiSquared_1, track_PixelShared_1, track_SCTShared_1, track_PixelHoles_1, track_SCTHoles_1, track_PixelHits_1, track_SCTHits_1, track_pt_2, track_eta_2, track_phi_2, track_vertex_nParticles_2, track_d0_2, track_z0_2, track_chiSquared_2, track_PixelShared_2, track_SCTShared_2, track_PixelHoles_2, track_SCTHoles_2, track_PixelHits_2, track_SCTHits_2, track_pt_3, track_eta_3, track_phi_3, track_vertex_nParticles_3, track_d0_3, track_z0_3, track_chiSquared_3, track_PixelShared_3, track_SCTShared_3, track_PixelHoles_3, track_SCTHoles_3, track_PixelHits_3, track_SCTHits_3, track_pt_4, track_eta_4, track_phi_4, track_vertex_nParticles_4, track_d0_4, track_z0_4, track_chiSquared_4, track_PixelShared_4, track_SCTShared_4, track_PixelHoles_4, track_SCTHoles_4, track_PixelHits_4, track_SCTHits_4, track_pt_5, track_eta_5, track_phi_5, track_vertex_nParticles_5, track_d0_5, track_z0_5, track_chiSquared_5, track_PixelShared_5, track_SCTShared_5, track_PixelHoles_5, track_SCTHoles_5, track_PixelHits_5, track_SCTHits_5, track_pt_6, track_eta_6, track_phi_6, track_vertex_nParticles_6, track_d0_6, track_z0_6, track_chiSquared_6, track_PixelShared_6, track_SCTShared_6, track_PixelHoles_6, track_SCTHoles_6, track_PixelHits_6, track_SCTHits_6, track_pt_7, track_eta_7, track_phi_7, track_vertex_nParticles_7, track_d0_7, track_z0_7, track_chiSquared_7, track_PixelShared_7, track_SCTShared_7, track_PixelHoles_7, track_SCTHoles_7, track_PixelHits_7, track_SCTHits_7, track_pt_8, track_eta_8, track_phi_8, track_vertex_nParticles_8, track_d0_8, track_z0_8, track_chiSquared_8, track_PixelShared_8, track_SCTShared_8, track_PixelHoles_8, track_SCTHoles_8, track_PixelHits_8, track_SCTHits_8, track_pt_9, track_eta_9, track_phi_9, track_vertex_nParticles_9, track_d0_9, track_z0_9, track_chiSquared_9, track_PixelShared_9, track_SCTShared_9, track_PixelHoles_9, track_SCTHoles_9, track_PixelHits_9, track_SCTHits_9, track_pt_10, track_eta_10, track_phi_10, track_vertex_nParticles_10, track_d0_10, track_z0_10, track_chiSquared_10, track_PixelShared_10, track_SCTShared_10, track_PixelHoles_10, track_SCTHoles_10, track_PixelHits_10, track_SCTHits_10, track_pt_11, track_eta_11, track_phi_11, track_vertex_nParticles_11, track_d0_11, track_z0_11, track_chiSquared_11, track_PixelShared_11, track_SCTShared_11, track_PixelHoles_11, track_SCTHoles_11, track_PixelHits_11, track_SCTHits_11, track_pt_12, track_eta_12, track_phi_12, track_vertex_nParticles_12, track_d0_12, track_z0_12, track_chiSquared_12, track_PixelShared_12, track_SCTShared_12, track_PixelHoles_12, track_SCTHoles_12, track_PixelHits_12, track_SCTHits_12, track_pt_13, track_eta_13, track_phi_13, track_vertex_nParticles_13, track_d0_13, track_z0_13, track_chiSquared_13, track_PixelShared_13, track_SCTShared_13, track_PixelHoles_13, track_SCTHoles_13, track_PixelHits_13, track_SCTHits_13, track_pt_14, track_eta_14, track_phi_14, track_vertex_nParticles_14, track_d0_14, track_z0_14, track_chiSquared_14, track_PixelShared_14, track_SCTShared_14, track_PixelHoles_14, track_SCTHoles_14, track_PixelHits_14, track_SCTHits_14, track_pt_15, track_eta_15, track_phi_15, track_vertex_nParticles_15, track_d0_15, track_z0_15, track_chiSquared_15, track_PixelShared_15, track_SCTShared_15, track_PixelHoles_15, track_SCTHoles_15, track_PixelHits_15, track_SCTHits_15, track_pt_16, track_eta_16, track_phi_16, track_vertex_nParticles_16, track_d0_16, track_z0_16, track_chiSquared_16, track_PixelShared_16, track_SCTShared_16, track_PixelHoles_16, track_SCTHoles_16, track_PixelHits_16, track_SCTHits_16, track_pt_17, track_eta_17, track_phi_17, track_vertex_nParticles_17, track_d0_17, track_z0_17, track_chiSquared_17, track_PixelShared_17, track_SCTShared_17, track_PixelHoles_17, track_SCTHoles_17, track_PixelHits_17, track_SCTHits_17, track_pt_18, track_eta_18, track_phi_18, track_vertex_nParticles_18, track_d0_18, track_z0_18, track_chiSquared_18, track_PixelShared_18, track_SCTShared_18, track_PixelHoles_18, track_SCTHoles_18, track_PixelHits_18, track_SCTHits_18, track_pt_19, track_eta_19, track_phi_19, track_vertex_nParticles_19, track_d0_19, track_z0_19, track_chiSquared_19, track_PixelShared_19, track_SCTShared_19, track_PixelHoles_19, track_SCTHoles_19, track_PixelHits_19, track_SCTHits_19, MSeg_etaPos_0, MSeg_phiPos_0, MSeg_etaDir_0, MSeg_phiDir_0, MSeg_chiSquared_0, MSeg_t0_0, MSeg_etaPos_1, MSeg_phiPos_1, MSeg_etaDir_1, MSeg_phiDir_1, MSeg_chiSquared_1, MSeg_t0_1, MSeg_etaPos_2, MSeg_phiPos_2, MSeg_etaDir_2, MSeg_phiDir_2, MSeg_chiSquared_2, MSeg_t0_2, MSeg_etaPos_3, MSeg_phiPos_3, MSeg_etaDir_3, MSeg_phiDir_3, MSeg_chiSquared_3, MSeg_t0_3, MSeg_etaPos_4, MSeg_phiPos_4, MSeg_etaDir_4, MSeg_phiDir_4, MSeg_chiSquared_4, MSeg_t0_4, MSeg_etaPos_5, MSeg_phiPos_5, MSeg_etaDir_5, MSeg_phiDir_5, MSeg_chiSquared_5, MSeg_t0_5, MSeg_etaPos_6, MSeg_phiPos_6, MSeg_etaDir_6, MSeg_phiDir_6, MSeg_chiSquared_6, MSeg_t0_6, MSeg_etaPos_7, MSeg_phiPos_7, MSeg_etaDir_7, MSeg_phiDir_7, MSeg_chiSquared_7, MSeg_t0_7, MSeg_etaPos_8, MSeg_phiPos_8, MSeg_etaDir_8, MSeg_phiDir_8, MSeg_chiSquared_8, MSeg_t0_8, MSeg_etaPos_9, MSeg_phiPos_9, MSeg_etaDir_9, MSeg_phiDir_9, MSeg_chiSquared_9, MSeg_t0_9, MSeg_etaPos_10, MSeg_phiPos_10, MSeg_etaDir_10, MSeg_phiDir_10, MSeg_chiSquared_10, MSeg_t0_10, MSeg_etaPos_11, MSeg_phiPos_11, MSeg_etaDir_11, MSeg_phiDir_11, MSeg_chiSquared_11, MSeg_t0_11, MSeg_etaPos_12, MSeg_phiPos_12, MSeg_etaDir_12, MSeg_phiDir_12, MSeg_chiSquared_12, MSeg_t0_12, MSeg_etaPos_13, MSeg_phiPos_13, MSeg_etaDir_13, MSeg_phiDir_13, MSeg_chiSquared_13, MSeg_t0_13, MSeg_etaPos_14, MSeg_phiPos_14, MSeg_etaDir_14, MSeg_phiDir_14, MSeg_chiSquared_14, MSeg_t0_14, MSeg_etaPos_15, MSeg_phiPos_15, MSeg_etaDir_15, MSeg_phiDir_15, MSeg_chiSquared_15, MSeg_t0_15, MSeg_etaPos_16, MSeg_phiPos_16, MSeg_etaDir_16, MSeg_phiDir_16, MSeg_chiSquared_16, MSeg_t0_16, MSeg_etaPos_17, MSeg_phiPos_17, MSeg_etaDir_17, MSeg_phiDir_17, MSeg_chiSquared_17, MSeg_t0_17, MSeg_etaPos_18, MSeg_phiPos_18, MSeg_etaDir_18, MSeg_phiDir_18, MSeg_chiSquared_18, MSeg_t0_18, MSeg_etaPos_19, MSeg_phiPos_19, MSeg_etaDir_19, MSeg_phiDir_19, MSeg_chiSquared_19, MSeg_t0_19, MSeg_etaPos_20, MSeg_phiPos_20, MSeg_etaDir_20, MSeg_phiDir_20, MSeg_chiSquared_20, MSeg_t0_20, MSeg_etaPos_21, MSeg_phiPos_21, MSeg_etaDir_21, MSeg_phiDir_21, MSeg_chiSquared_21, MSeg_t0_21, MSeg_etaPos_22, MSeg_phiPos_22, MSeg_etaDir_22, MSeg_phiDir_22, MSeg_chiSquared_22, MSeg_t0_22, MSeg_etaPos_23, MSeg_phiPos_23, MSeg_etaDir_23, MSeg_phiDir_23, MSeg_chiSquared_23, MSeg_t0_23, MSeg_etaPos_24, MSeg_phiPos_24, MSeg_etaDir_24, MSeg_phiDir_24, MSeg_chiSquared_24, MSeg_t0_24, MSeg_etaPos_25, MSeg_phiPos_25, MSeg_etaDir_25, MSeg_phiDir_25, MSeg_chiSquared_25, MSeg_t0_25, MSeg_etaPos_26, MSeg_phiPos_26, MSeg_etaDir_26, MSeg_phiDir_26, MSeg_chiSquared_26, MSeg_t0_26, MSeg_etaPos_27, MSeg_phiPos_27, MSeg_etaDir_27, MSeg_phiDir_27, MSeg_chiSquared_27, MSeg_t0_27, MSeg_etaPos_28, MSeg_phiPos_28, MSeg_etaDir_28, MSeg_phiDir_28, MSeg_chiSquared_28, MSeg_t0_28, MSeg_etaPos_29, MSeg_phiPos_29, MSeg_etaDir_29, MSeg_phiDir_29, MSeg_chiSquared_29, MSeg_t0_29
2024-09-13 10:54:53,865 - root - INFO - Loading main training data from https://cernbox.cern.ch/remote.php/dav/public-files/32dqr9gSbmQdj3W/processed_output_Lxy1500_Lz3000_3_slim05.pkl...
2024-09-13 10:54:59,634 - root - DEBUG -    index  label  mcEventWeight  ...  MSeg_chiSquared_29  MSeg_t0_29  data_year
0  40356    0.0       2.278246  ...                 0.0         0.0        0.0
1   6270    1.0       1.000000  ...                 0.0         0.0        0.0
2  13850    1.0       1.000000  ...                 0.0         0.0        0.0
3  37263    1.0       1.000000  ...                 0.0         0.0        0.0
4   8231    0.0      20.726152  ...                 0.0         0.0        0.0

[5 rows x 819 columns]
2024-09-13 10:55:00,847 - root - INFO -   Length of Signal is: 66004
2024-09-13 10:55:01,613 - root - INFO -   Length of QCD is: 76648
2024-09-13 10:55:02,290 - root - INFO -   Length of BIB is: 66084
2024-09-13 10:55:02,290 - root - DEBUG -   Column names for this data file: index, label, mcEventWeight, flatWeight, jet_pt, jet_eta, jet_phi, jet_isClean_LooseBadLLP, llp_Lxy, llp_Lz, llp_pt, llp_eta, llp_phi, llp_mH, llp_mS, eventNumber, runNumber, decay_distance, clus_pt_0, clus_eta_0, clus_phi_0, clus_l1hcal_0, clus_l1ecal_0, clus_l2hcal_0, clus_l2ecal_0, clus_l3hcal_0, clus_l3ecal_0, clus_l4ecal_0, clus_l4hcal_0, clus_time_0, clus_pt_1, clus_eta_1, clus_phi_1, clus_l1hcal_1, clus_l1ecal_1, clus_l2hcal_1, clus_l2ecal_1, clus_l3hcal_1, clus_l3ecal_1, clus_l4ecal_1, clus_l4hcal_1, clus_time_1, clus_pt_2, clus_eta_2, clus_phi_2, clus_l1hcal_2, clus_l1ecal_2, clus_l2hcal_2, clus_l2ecal_2, clus_l3hcal_2, clus_l3ecal_2, clus_l4ecal_2, clus_l4hcal_2, clus_time_2, clus_pt_3, clus_eta_3, clus_phi_3, clus_l1hcal_3, clus_l1ecal_3, clus_l2hcal_3, clus_l2ecal_3, clus_l3hcal_3, clus_l3ecal_3, clus_l4ecal_3, clus_l4hcal_3, clus_time_3, clus_pt_4, clus_eta_4, clus_phi_4, clus_l1hcal_4, clus_l1ecal_4, clus_l2hcal_4, clus_l2ecal_4, clus_l3hcal_4, clus_l3ecal_4, clus_l4ecal_4, clus_l4hcal_4, clus_time_4, clus_pt_5, clus_eta_5, clus_phi_5, clus_l1hcal_5, clus_l1ecal_5, clus_l2hcal_5, clus_l2ecal_5, clus_l3hcal_5, clus_l3ecal_5, clus_l4ecal_5, clus_l4hcal_5, clus_time_5, clus_pt_6, clus_eta_6, clus_phi_6, clus_l1hcal_6, clus_l1ecal_6, clus_l2hcal_6, clus_l2ecal_6, clus_l3hcal_6, clus_l3ecal_6, clus_l4ecal_6, clus_l4hcal_6, clus_time_6, clus_pt_7, clus_eta_7, clus_phi_7, clus_l1hcal_7, clus_l1ecal_7, clus_l2hcal_7, clus_l2ecal_7, clus_l3hcal_7, clus_l3ecal_7, clus_l4ecal_7, clus_l4hcal_7, clus_time_7, clus_pt_8, clus_eta_8, clus_phi_8, clus_l1hcal_8, clus_l1ecal_8, clus_l2hcal_8, clus_l2ecal_8, clus_l3hcal_8, clus_l3ecal_8, clus_l4ecal_8, clus_l4hcal_8, clus_time_8, clus_pt_9, clus_eta_9, clus_phi_9, clus_l1hcal_9, clus_l1ecal_9, clus_l2hcal_9, clus_l2ecal_9, clus_l3hcal_9, clus_l3ecal_9, clus_l4ecal_9, clus_l4hcal_9, clus_time_9, clus_pt_10, clus_eta_10, clus_phi_10, clus_l1hcal_10, clus_l1ecal_10, clus_l2hcal_10, clus_l2ecal_10, clus_l3hcal_10, clus_l3ecal_10, clus_l4ecal_10, clus_l4hcal_10, clus_time_10, clus_pt_11, clus_eta_11, clus_phi_11, clus_l1hcal_11, clus_l1ecal_11, clus_l2hcal_11, clus_l2ecal_11, clus_l3hcal_11, clus_l3ecal_11, clus_l4ecal_11, clus_l4hcal_11, clus_time_11, clus_pt_12, clus_eta_12, clus_phi_12, clus_l1hcal_12, clus_l1ecal_12, clus_l2hcal_12, clus_l2ecal_12, clus_l3hcal_12, clus_l3ecal_12, clus_l4ecal_12, clus_l4hcal_12, clus_time_12, clus_pt_13, clus_eta_13, clus_phi_13, clus_l1hcal_13, clus_l1ecal_13, clus_l2hcal_13, clus_l2ecal_13, clus_l3hcal_13, clus_l3ecal_13, clus_l4ecal_13, clus_l4hcal_13, clus_time_13, clus_pt_14, clus_eta_14, clus_phi_14, clus_l1hcal_14, clus_l1ecal_14, clus_l2hcal_14, clus_l2ecal_14, clus_l3hcal_14, clus_l3ecal_14, clus_l4ecal_14, clus_l4hcal_14, clus_time_14, clus_pt_15, clus_eta_15, clus_phi_15, clus_l1hcal_15, clus_l1ecal_15, clus_l2hcal_15, clus_l2ecal_15, clus_l3hcal_15, clus_l3ecal_15, clus_l4ecal_15, clus_l4hcal_15, clus_time_15, clus_pt_16, clus_eta_16, clus_phi_16, clus_l1hcal_16, clus_l1ecal_16, clus_l2hcal_16, clus_l2ecal_16, clus_l3hcal_16, clus_l3ecal_16, clus_l4ecal_16, clus_l4hcal_16, clus_time_16, clus_pt_17, clus_eta_17, clus_phi_17, clus_l1hcal_17, clus_l1ecal_17, clus_l2hcal_17, clus_l2ecal_17, clus_l3hcal_17, clus_l3ecal_17, clus_l4ecal_17, clus_l4hcal_17, clus_time_17, clus_pt_18, clus_eta_18, clus_phi_18, clus_l1hcal_18, clus_l1ecal_18, clus_l2hcal_18, clus_l2ecal_18, clus_l3hcal_18, clus_l3ecal_18, clus_l4ecal_18, clus_l4hcal_18, clus_time_18, clus_pt_19, clus_eta_19, clus_phi_19, clus_l1hcal_19, clus_l1ecal_19, clus_l2hcal_19, clus_l2ecal_19, clus_l3hcal_19, clus_l3ecal_19, clus_l4ecal_19, clus_l4hcal_19, clus_time_19, clus_pt_20, clus_eta_20, clus_phi_20, clus_l1hcal_20, clus_l1ecal_20, clus_l2hcal_20, clus_l2ecal_20, clus_l3hcal_20, clus_l3ecal_20, clus_l4ecal_20, clus_l4hcal_20, clus_time_20, clus_pt_21, clus_eta_21, clus_phi_21, clus_l1hcal_21, clus_l1ecal_21, clus_l2hcal_21, clus_l2ecal_21, clus_l3hcal_21, clus_l3ecal_21, clus_l4ecal_21, clus_l4hcal_21, clus_time_21, clus_pt_22, clus_eta_22, clus_phi_22, clus_l1hcal_22, clus_l1ecal_22, clus_l2hcal_22, clus_l2ecal_22, clus_l3hcal_22, clus_l3ecal_22, clus_l4ecal_22, clus_l4hcal_22, clus_time_22, clus_pt_23, clus_eta_23, clus_phi_23, clus_l1hcal_23, clus_l1ecal_23, clus_l2hcal_23, clus_l2ecal_23, clus_l3hcal_23, clus_l3ecal_23, clus_l4ecal_23, clus_l4hcal_23, clus_time_23, clus_pt_24, clus_eta_24, clus_phi_24, clus_l1hcal_24, clus_l1ecal_24, clus_l2hcal_24, clus_l2ecal_24, clus_l3hcal_24, clus_l3ecal_24, clus_l4ecal_24, clus_l4hcal_24, clus_time_24, clus_pt_25, clus_eta_25, clus_phi_25, clus_l1hcal_25, clus_l1ecal_25, clus_l2hcal_25, clus_l2ecal_25, clus_l3hcal_25, clus_l3ecal_25, clus_l4ecal_25, clus_l4hcal_25, clus_time_25, clus_pt_26, clus_eta_26, clus_phi_26, clus_l1hcal_26, clus_l1ecal_26, clus_l2hcal_26, clus_l2ecal_26, clus_l3hcal_26, clus_l3ecal_26, clus_l4ecal_26, clus_l4hcal_26, clus_time_26, clus_pt_27, clus_eta_27, clus_phi_27, clus_l1hcal_27, clus_l1ecal_27, clus_l2hcal_27, clus_l2ecal_27, clus_l3hcal_27, clus_l3ecal_27, clus_l4ecal_27, clus_l4hcal_27, clus_time_27, clus_pt_28, clus_eta_28, clus_phi_28, clus_l1hcal_28, clus_l1ecal_28, clus_l2hcal_28, clus_l2ecal_28, clus_l3hcal_28, clus_l3ecal_28, clus_l4ecal_28, clus_l4hcal_28, clus_time_28, clus_pt_29, clus_eta_29, clus_phi_29, clus_l1hcal_29, clus_l1ecal_29, clus_l2hcal_29, clus_l2ecal_29, clus_l3hcal_29, clus_l3ecal_29, clus_l4ecal_29, clus_l4hcal_29, clus_time_29, track_pt_0, track_eta_0, track_phi_0, track_vertex_nParticles_0, track_d0_0, track_z0_0, track_chiSquared_0, track_PixelShared_0, track_SCTShared_0, track_PixelHoles_0, track_SCTHoles_0, track_PixelHits_0, track_SCTHits_0, track_pt_1, track_eta_1, track_phi_1, track_vertex_nParticles_1, track_d0_1, track_z0_1, track_chiSquared_1, track_PixelShared_1, track_SCTShared_1, track_PixelHoles_1, track_SCTHoles_1, track_PixelHits_1, track_SCTHits_1, track_pt_2, track_eta_2, track_phi_2, track_vertex_nParticles_2, track_d0_2, track_z0_2, track_chiSquared_2, track_PixelShared_2, track_SCTShared_2, track_PixelHoles_2, track_SCTHoles_2, track_PixelHits_2, track_SCTHits_2, track_pt_3, track_eta_3, track_phi_3, track_vertex_nParticles_3, track_d0_3, track_z0_3, track_chiSquared_3, track_PixelShared_3, track_SCTShared_3, track_PixelHoles_3, track_SCTHoles_3, track_PixelHits_3, track_SCTHits_3, track_pt_4, track_eta_4, track_phi_4, track_vertex_nParticles_4, track_d0_4, track_z0_4, track_chiSquared_4, track_PixelShared_4, track_SCTShared_4, track_PixelHoles_4, track_SCTHoles_4, track_PixelHits_4, track_SCTHits_4, track_pt_5, track_eta_5, track_phi_5, track_vertex_nParticles_5, track_d0_5, track_z0_5, track_chiSquared_5, track_PixelShared_5, track_SCTShared_5, track_PixelHoles_5, track_SCTHoles_5, track_PixelHits_5, track_SCTHits_5, track_pt_6, track_eta_6, track_phi_6, track_vertex_nParticles_6, track_d0_6, track_z0_6, track_chiSquared_6, track_PixelShared_6, track_SCTShared_6, track_PixelHoles_6, track_SCTHoles_6, track_PixelHits_6, track_SCTHits_6, track_pt_7, track_eta_7, track_phi_7, track_vertex_nParticles_7, track_d0_7, track_z0_7, track_chiSquared_7, track_PixelShared_7, track_SCTShared_7, track_PixelHoles_7, track_SCTHoles_7, track_PixelHits_7, track_SCTHits_7, track_pt_8, track_eta_8, track_phi_8, track_vertex_nParticles_8, track_d0_8, track_z0_8, track_chiSquared_8, track_PixelShared_8, track_SCTShared_8, track_PixelHoles_8, track_SCTHoles_8, track_PixelHits_8, track_SCTHits_8, track_pt_9, track_eta_9, track_phi_9, track_vertex_nParticles_9, track_d0_9, track_z0_9, track_chiSquared_9, track_PixelShared_9, track_SCTShared_9, track_PixelHoles_9, track_SCTHoles_9, track_PixelHits_9, track_SCTHits_9, track_pt_10, track_eta_10, track_phi_10, track_vertex_nParticles_10, track_d0_10, track_z0_10, track_chiSquared_10, track_PixelShared_10, track_SCTShared_10, track_PixelHoles_10, track_SCTHoles_10, track_PixelHits_10, track_SCTHits_10, track_pt_11, track_eta_11, track_phi_11, track_vertex_nParticles_11, track_d0_11, track_z0_11, track_chiSquared_11, track_PixelShared_11, track_SCTShared_11, track_PixelHoles_11, track_SCTHoles_11, track_PixelHits_11, track_SCTHits_11, track_pt_12, track_eta_12, track_phi_12, track_vertex_nParticles_12, track_d0_12, track_z0_12, track_chiSquared_12, track_PixelShared_12, track_SCTShared_12, track_PixelHoles_12, track_SCTHoles_12, track_PixelHits_12, track_SCTHits_12, track_pt_13, track_eta_13, track_phi_13, track_vertex_nParticles_13, track_d0_13, track_z0_13, track_chiSquared_13, track_PixelShared_13, track_SCTShared_13, track_PixelHoles_13, track_SCTHoles_13, track_PixelHits_13, track_SCTHits_13, track_pt_14, track_eta_14, track_phi_14, track_vertex_nParticles_14, track_d0_14, track_z0_14, track_chiSquared_14, track_PixelShared_14, track_SCTShared_14, track_PixelHoles_14, track_SCTHoles_14, track_PixelHits_14, track_SCTHits_14, track_pt_15, track_eta_15, track_phi_15, track_vertex_nParticles_15, track_d0_15, track_z0_15, track_chiSquared_15, track_PixelShared_15, track_SCTShared_15, track_PixelHoles_15, track_SCTHoles_15, track_PixelHits_15, track_SCTHits_15, track_pt_16, track_eta_16, track_phi_16, track_vertex_nParticles_16, track_d0_16, track_z0_16, track_chiSquared_16, track_PixelShared_16, track_SCTShared_16, track_PixelHoles_16, track_SCTHoles_16, track_PixelHits_16, track_SCTHits_16, track_pt_17, track_eta_17, track_phi_17, track_vertex_nParticles_17, track_d0_17, track_z0_17, track_chiSquared_17, track_PixelShared_17, track_SCTShared_17, track_PixelHoles_17, track_SCTHoles_17, track_PixelHits_17, track_SCTHits_17, track_pt_18, track_eta_18, track_phi_18, track_vertex_nParticles_18, track_d0_18, track_z0_18, track_chiSquared_18, track_PixelShared_18, track_SCTShared_18, track_PixelHoles_18, track_SCTHoles_18, track_PixelHits_18, track_SCTHits_18, track_pt_19, track_eta_19, track_phi_19, track_vertex_nParticles_19, track_d0_19, track_z0_19, track_chiSquared_19, track_PixelShared_19, track_SCTShared_19, track_PixelHoles_19, track_SCTHoles_19, track_PixelHits_19, track_SCTHits_19, MSeg_etaPos_0, MSeg_phiPos_0, MSeg_etaDir_0, MSeg_phiDir_0, MSeg_chiSquared_0, MSeg_t0_0, MSeg_etaPos_1, MSeg_phiPos_1, MSeg_etaDir_1, MSeg_phiDir_1, MSeg_chiSquared_1, MSeg_t0_1, MSeg_etaPos_2, MSeg_phiPos_2, MSeg_etaDir_2, MSeg_phiDir_2, MSeg_chiSquared_2, MSeg_t0_2, MSeg_etaPos_3, MSeg_phiPos_3, MSeg_etaDir_3, MSeg_phiDir_3, MSeg_chiSquared_3, MSeg_t0_3, MSeg_etaPos_4, MSeg_phiPos_4, MSeg_etaDir_4, MSeg_phiDir_4, MSeg_chiSquared_4, MSeg_t0_4, MSeg_etaPos_5, MSeg_phiPos_5, MSeg_etaDir_5, MSeg_phiDir_5, MSeg_chiSquared_5, MSeg_t0_5, MSeg_etaPos_6, MSeg_phiPos_6, MSeg_etaDir_6, MSeg_phiDir_6, MSeg_chiSquared_6, MSeg_t0_6, MSeg_etaPos_7, MSeg_phiPos_7, MSeg_etaDir_7, MSeg_phiDir_7, MSeg_chiSquared_7, MSeg_t0_7, MSeg_etaPos_8, MSeg_phiPos_8, MSeg_etaDir_8, MSeg_phiDir_8, MSeg_chiSquared_8, MSeg_t0_8, MSeg_etaPos_9, MSeg_phiPos_9, MSeg_etaDir_9, MSeg_phiDir_9, MSeg_chiSquared_9, MSeg_t0_9, MSeg_etaPos_10, MSeg_phiPos_10, MSeg_etaDir_10, MSeg_phiDir_10, MSeg_chiSquared_10, MSeg_t0_10, MSeg_etaPos_11, MSeg_phiPos_11, MSeg_etaDir_11, MSeg_phiDir_11, MSeg_chiSquared_11, MSeg_t0_11, MSeg_etaPos_12, MSeg_phiPos_12, MSeg_etaDir_12, MSeg_phiDir_12, MSeg_chiSquared_12, MSeg_t0_12, MSeg_etaPos_13, MSeg_phiPos_13, MSeg_etaDir_13, MSeg_phiDir_13, MSeg_chiSquared_13, MSeg_t0_13, MSeg_etaPos_14, MSeg_phiPos_14, MSeg_etaDir_14, MSeg_phiDir_14, MSeg_chiSquared_14, MSeg_t0_14, MSeg_etaPos_15, MSeg_phiPos_15, MSeg_etaDir_15, MSeg_phiDir_15, MSeg_chiSquared_15, MSeg_t0_15, MSeg_etaPos_16, MSeg_phiPos_16, MSeg_etaDir_16, MSeg_phiDir_16, MSeg_chiSquared_16, MSeg_t0_16, MSeg_etaPos_17, MSeg_phiPos_17, MSeg_etaDir_17, MSeg_phiDir_17, MSeg_chiSquared_17, MSeg_t0_17, MSeg_etaPos_18, MSeg_phiPos_18, MSeg_etaDir_18, MSeg_phiDir_18, MSeg_chiSquared_18, MSeg_t0_18, MSeg_etaPos_19, MSeg_phiPos_19, MSeg_etaDir_19, MSeg_phiDir_19, MSeg_chiSquared_19, MSeg_t0_19, MSeg_etaPos_20, MSeg_phiPos_20, MSeg_etaDir_20, MSeg_phiDir_20, MSeg_chiSquared_20, MSeg_t0_20, MSeg_etaPos_21, MSeg_phiPos_21, MSeg_etaDir_21, MSeg_phiDir_21, MSeg_chiSquared_21, MSeg_t0_21, MSeg_etaPos_22, MSeg_phiPos_22, MSeg_etaDir_22, MSeg_phiDir_22, MSeg_chiSquared_22, MSeg_t0_22, MSeg_etaPos_23, MSeg_phiPos_23, MSeg_etaDir_23, MSeg_phiDir_23, MSeg_chiSquared_23, MSeg_t0_23, MSeg_etaPos_24, MSeg_phiPos_24, MSeg_etaDir_24, MSeg_phiDir_24, MSeg_chiSquared_24, MSeg_t0_24, MSeg_etaPos_25, MSeg_phiPos_25, MSeg_etaDir_25, MSeg_phiDir_25, MSeg_chiSquared_25, MSeg_t0_25, MSeg_etaPos_26, MSeg_phiPos_26, MSeg_etaDir_26, MSeg_phiDir_26, MSeg_chiSquared_26, MSeg_t0_26, MSeg_etaPos_27, MSeg_phiPos_27, MSeg_etaDir_27, MSeg_phiDir_27, MSeg_chiSquared_27, MSeg_t0_27, MSeg_etaPos_28, MSeg_phiPos_28, MSeg_etaDir_28, MSeg_phiDir_28, MSeg_chiSquared_28, MSeg_t0_28, MSeg_etaPos_29, MSeg_phiPos_29, MSeg_etaDir_29, MSeg_phiDir_29, MSeg_chiSquared_29, MSeg_t0_29, data_year
2024-09-13 10:55:03,841 - root - DEBUG - mcWeights
2024-09-13 10:55:03,848 - root - DEBUG - label 0: 176021      1.831497
134684      5.190014
56518       8.372709
176354      4.240664
153315      4.469862
             ...    
117585      2.996905
159665      5.433999
186096      4.839425
57390     151.577011
121348     31.348543
Name: mcEventWeight, Length: 38322, dtype: float32
2024-09-13 10:55:06,378 - root - DEBUG - Writing out test data to training_results/default/y_test.npz
2024-09-13 10:55:06,387 - root - DEBUG - Preparing jet constituent data
2024-09-13 10:55:06,814 - root - DEBUG -   Shape: 30 x 12
2024-09-13 10:55:06,815 - root - DEBUG -   Number of training examples 93931
2024-09-13 10:55:06,815 - root - DEBUG -   Number of validating examples 5219
2024-09-13 10:55:06,815 - root - DEBUG -   Number of testing examples 5218
2024-09-13 10:55:06,816 - root - DEBUG - Preparing jet constituent data (adversary)
2024-09-13 10:55:06,953 - root - DEBUG -   Shape: 30 x 12
2024-09-13 10:55:06,953 - root - DEBUG -   Number of training examples 202129
2024-09-13 10:55:06,954 - root - DEBUG -   Number of validating examples 11230
2024-09-13 10:55:06,954 - root - DEBUG -   Number of testing examples 11229
2024-09-13 10:55:06,954 - root - DEBUG - Preparing track data
2024-09-13 10:55:09,819 - root - DEBUG -   Shape: 20 x 10
2024-09-13 10:55:09,819 - root - DEBUG -   Number of training examples 93931
2024-09-13 10:55:09,820 - root - DEBUG -   Number of validating examples 5219
2024-09-13 10:55:09,820 - root - DEBUG -   Number of testing examples 5218
2024-09-13 10:55:09,820 - root - DEBUG - Preparing track data (adversary)
2024-09-13 10:55:12,351 - root - DEBUG -   Shape: 20 x 10
2024-09-13 10:55:12,351 - root - DEBUG -   Number of training examples 202129
2024-09-13 10:55:12,352 - root - DEBUG -   Number of validating examples 11230
2024-09-13 10:55:12,352 - root - DEBUG -   Number of testing examples 11229
2024-09-13 10:55:12,352 - root - DEBUG - Preparing MSeg data
2024-09-13 10:55:12,561 - root - DEBUG -   Shape: 30 x 6
2024-09-13 10:55:12,562 - root - DEBUG -   Number of training examples 93931
2024-09-13 10:55:12,562 - root - DEBUG -   Number of validating examples 5219
2024-09-13 10:55:12,562 - root - DEBUG -   Number of testing examples 5218
2024-09-13 10:55:12,563 - root - DEBUG - Preparing MSeg data (adversary)
2024-09-13 10:55:12,638 - root - DEBUG -   Shape: 30 x 6
2024-09-13 10:55:12,639 - root - DEBUG -   Number of training examples 202129
2024-09-13 10:55:12,639 - root - DEBUG -   Number of validating examples 11230
2024-09-13 10:55:12,639 - root - DEBUG -   Number of testing examples 11229
2024-09-13 10:55:12,640 - root - DEBUG - Preparing jet data
2024-09-13 10:55:12,649 - root - DEBUG -   Shape: 3
2024-09-13 10:55:12,649 - root - DEBUG -   Number of training examples 93931
2024-09-13 10:55:12,650 - root - DEBUG -   Number of validating examples 5219
2024-09-13 10:55:12,650 - root - DEBUG -   Number of testing examples 5218
2024-09-13 10:55:12,659 - root - DEBUG -   Shape: 3
2024-09-13 10:55:12,659 - root - DEBUG -   Number of training examples 202129
2024-09-13 10:55:12,659 - root - DEBUG -   Number of validating examples 11230
2024-09-13 10:55:12,660 - root - DEBUG -   Number of testing examples 11229
2024-09-13 10:55:12,662 - root - DEBUG - Done preparing data for model
2024-09-13 10:55:12,669 - root - DEBUG - Writing out test data to training_results/default/x_to_test.npz
2024-09-13 10:55:13,040 - root - DEBUG - Gen RAM Free: 19 GB | Used: 8 GB | Util   5% | Total 189 GB
2024-09-13 10:55:13,223 - root - DEBUG - GPU RAM Free: 23011 MB | Used: 17 MB | Util   0% | Total 23028 MB
2024-09-13 10:55:13,224 - root - DEBUG - Setting up model architecture...
/home/fye/anaconda3/envs/cuda_env/lib/python3.10/site-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
2024-09-13 10:55:13.931177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:2021] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20840 MB memory:  -> device: 0, name: NVIDIA A10, pci bus id: 0000:18:00.0, compute capability: 8.6
2024-09-13 10:55:13.933320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:2021] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 20840 MB memory:  -> device: 1, name: NVIDIA A10, pci bus id: 0000:3b:00.0, compute capability: 8.6
2024-09-13 10:55:13.935561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:2021] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 20840 MB memory:  -> device: 2, name: NVIDIA A10, pci bus id: 0000:86:00.0, compute capability: 8.6
2024-09-13 10:55:13.937545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:2021] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 20840 MB memory:  -> device: 3, name: NVIDIA A10, pci bus id: 0000:af:00.0, compute capability: 8.6
2024-09-13 10:55:16,641 - root - DEBUG - Gen RAM Free: 19 GB | Used: 8 GB | Util   5% | Total 189 GB
2024-09-13 10:55:16,755 - root - DEBUG - GPU RAM Free: 22776 MB | Used: 252 MB | Util   1% | Total 23028 MB
/home/fye/anaconda3/envs/cuda_env/lib/python3.10/site-packages/numpy/core/fromnumeric.py:57: FutureWarning: 'Series.swapaxes' is deprecated and will be removed in a future version. Please use 'Series.transpose' instead.
  return bound(*args, **kwds)
2024-09-13 10:55:18,766 - root - DEBUG - Summary of the original model:
2024-09-13 10:55:19,552 - root - DEBUG - Model: "original_model"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ constit_input_cr    │ (None, 30, 12)    │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ track_input_cr      │ (None, 20, 10)    │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ constit_input_adv   │ (None, 30, 12)    │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ track_input_adv     │ (None, 20, 10)    │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d (Conv1D)     │ (None, 30, 64)    │        832 │ constit_input_cr… │
│                     │                   │            │ constit_input_ad… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_3 (Conv1D)   │ (None, 20, 64)    │        704 │ track_input_cr[0… │
│                     │                   │            │ track_input_adv[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_1 (Conv1D)   │ (None, 30, 32)    │      2,080 │ conv1d[0][0],     │
│                     │                   │            │ conv1d[1][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_4 (Conv1D)   │ (None, 20, 32)    │      2,080 │ conv1d_3[0][0],   │
│                     │                   │            │ conv1d_3[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ MSeg_input_cr       │ (None, 30, 6)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ MSeg_input_adv      │ (None, 30, 6)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout (Dropout)   │ (None, 30, 32)    │          0 │ conv1d_1[0][0],   │
│                     │                   │            │ conv1d_1[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_4 (Dropout) │ (None, 20, 32)    │          0 │ conv1d_4[0][0],   │
│                     │                   │            │ conv1d_4[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_6 (Conv1D)   │ (None, 30, 32)    │        224 │ MSeg_input_cr[0]… │
│                     │                   │            │ MSeg_input_adv[0… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_2 (Conv1D)   │ (None, 30, 32)    │      1,056 │ dropout[0][0],    │
│                     │                   │            │ dropout[1][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_5 (Conv1D)   │ (None, 20, 32)    │      1,056 │ dropout_4[0][0],  │
│                     │                   │            │ dropout_4[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_7 (Conv1D)   │ (None, 30, 16)    │        528 │ conv1d_6[0][0],   │
│                     │                   │            │ conv1d_6[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_1 (Dropout) │ (None, 30, 32)    │          0 │ conv1d_2[0][0],   │
│                     │                   │            │ conv1d_2[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_5 (Dropout) │ (None, 20, 32)    │          0 │ conv1d_5[0][0],   │
│                     │                   │            │ conv1d_5[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_8 (Dropout) │ (None, 30, 16)    │          0 │ conv1d_7[0][0],   │
│                     │                   │            │ conv1d_7[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ constit_final_conv… │ (None, 30, 16)    │        528 │ dropout_1[0][0],  │
│ (Conv1D)            │                   │            │ dropout_1[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ track_final_conv1d  │ (None, 20, 16)    │        528 │ dropout_5[0][0],  │
│ (Conv1D)            │                   │            │ dropout_5[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ MSeg_final_conv1d   │ (None, 30, 8)     │        136 │ dropout_8[0][0],  │
│ (Conv1D)            │                   │            │ dropout_8[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_2 (Dropout) │ (None, 30, 16)    │          0 │ constit_final_co… │
│                     │                   │            │ constit_final_co… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_6 (Dropout) │ (None, 20, 16)    │          0 │ track_final_conv… │
│                     │                   │            │ track_final_conv… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_9 (Dropout) │ (None, 30, 8)     │          0 │ MSeg_final_conv1… │
│                     │                   │            │ MSeg_final_conv1… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm (LSTM)         │ (None, 10)        │      1,080 │ dropout_2[0][0],  │
│                     │                   │            │ dropout_2[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_1 (LSTM)       │ (None, 10)        │      1,080 │ dropout_6[0][0],  │
│                     │                   │            │ dropout_6[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_2 (LSTM)       │ (None, 5)         │        280 │ dropout_9[0][0],  │
│                     │                   │            │ dropout_9[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_3 (Dropout) │ (None, 10)        │          0 │ lstm[0][0],       │
│                     │                   │            │ lstm[1][0]        │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_7 (Dropout) │ (None, 10)        │          0 │ lstm_1[0][0],     │
│                     │                   │            │ lstm_1[1][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_10          │ (None, 5)         │          0 │ lstm_2[0][0],     │
│ (Dropout)           │                   │            │ lstm_2[1][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ jet_input_cr        │ (None, 3)         │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ jet_input_adv       │ (None, 3)         │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 28)        │          0 │ dropout_3[0][0],  │
│ (Concatenate)       │                   │            │ dropout_7[0][0],  │
│                     │                   │            │ dropout_10[0][0], │
│                     │                   │            │ jet_input_cr[0][… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 28)        │          0 │ dropout_3[1][0],  │
│ (Concatenate)       │                   │            │ dropout_7[1][0],  │
│                     │                   │            │ dropout_10[1][0], │
│                     │                   │            │ jet_input_adv[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 512)       │     14,848 │ concatenate[0][0… │
│                     │                   │            │ concatenate_1[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_11          │ (None, 512)       │          0 │ dense_1[0][0],    │
│ (Dropout)           │                   │            │ dense_1[1][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 64)        │     32,832 │ dropout_11[0][0], │
│                     │                   │            │ dropout_11[1][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_12          │ (None, 64)        │          0 │ dense_2[0][0],    │
│ (Dropout)           │                   │            │ dense_2[1][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ main_output (Dense) │ (None, 3)         │        195 │ dropout_12[0][0], │
│                     │                   │            │ dropout_12[1][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_1    │ (None, 3)         │         12 │ main_output[1][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_1 (Dense) │ (None, 24)        │         96 │ adversary_norm_1… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_2    │ (None, 24)        │         96 │ adversary_1[0][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_2 (Dense) │ (None, 12)        │        300 │ adversary_norm_2… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_3    │ (None, 12)        │         48 │ adversary_2[0][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_3 (Dense) │ (None, 6)         │         78 │ adversary_norm_3… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_4    │ (None, 6)         │         24 │ adversary_3[0][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_out       │ (None, 1)         │          7 │ adversary_norm_4… │
│ (Dense)             │                   │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 60,728 (237.22 KB)
 Trainable params: 60,067 (234.64 KB)
 Non-trainable params: 661 (2.58 KB)

2024-09-13 10:55:19,553 - root - DEBUG - Summary of the discriminator model:
2024-09-13 10:55:20,185 - root - DEBUG - Model: "discriminator_model"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ constit_input_adv   │ (None, 30, 12)    │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ track_input_adv     │ (None, 20, 10)    │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d (Conv1D)     │ (None, 30, 64)    │        832 │ constit_input_ad… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_3 (Conv1D)   │ (None, 20, 64)    │        704 │ track_input_adv[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_1 (Conv1D)   │ (None, 30, 32)    │      2,080 │ conv1d[1][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_4 (Conv1D)   │ (None, 20, 32)    │      2,080 │ conv1d_3[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ MSeg_input_adv      │ (None, 30, 6)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout (Dropout)   │ (None, 30, 32)    │          0 │ conv1d_1[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_4 (Dropout) │ (None, 20, 32)    │          0 │ conv1d_4[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_6 (Conv1D)   │ (None, 30, 32)    │        224 │ MSeg_input_adv[0… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_2 (Conv1D)   │ (None, 30, 32)    │      1,056 │ dropout[1][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_5 (Conv1D)   │ (None, 20, 32)    │      1,056 │ dropout_4[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_7 (Conv1D)   │ (None, 30, 16)    │        528 │ conv1d_6[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_1 (Dropout) │ (None, 30, 32)    │          0 │ conv1d_2[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_5 (Dropout) │ (None, 20, 32)    │          0 │ conv1d_5[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_8 (Dropout) │ (None, 30, 16)    │          0 │ conv1d_7[1][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ constit_final_conv… │ (None, 30, 16)    │        528 │ dropout_1[1][0]   │
│ (Conv1D)            │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ track_final_conv1d  │ (None, 20, 16)    │        528 │ dropout_5[1][0]   │
│ (Conv1D)            │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ MSeg_final_conv1d   │ (None, 30, 8)     │        136 │ dropout_8[1][0]   │
│ (Conv1D)            │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_2 (Dropout) │ (None, 30, 16)    │          0 │ constit_final_co… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_6 (Dropout) │ (None, 20, 16)    │          0 │ track_final_conv… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_9 (Dropout) │ (None, 30, 8)     │          0 │ MSeg_final_conv1… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm (LSTM)         │ (None, 10)        │      1,080 │ dropout_2[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_1 (LSTM)       │ (None, 10)        │      1,080 │ dropout_6[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_2 (LSTM)       │ (None, 5)         │        280 │ dropout_9[1][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_3 (Dropout) │ (None, 10)        │          0 │ lstm[1][0]        │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_7 (Dropout) │ (None, 10)        │          0 │ lstm_1[1][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_10          │ (None, 5)         │          0 │ lstm_2[1][0]      │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ jet_input_adv       │ (None, 3)         │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 28)        │          0 │ dropout_3[1][0],  │
│ (Concatenate)       │                   │            │ dropout_7[1][0],  │
│                     │                   │            │ dropout_10[1][0], │
│                     │                   │            │ jet_input_adv[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 512)       │     14,848 │ concatenate_1[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_11          │ (None, 512)       │          0 │ dense_1[1][0]     │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 64)        │     32,832 │ dropout_11[1][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_12          │ (None, 64)        │          0 │ dense_2[1][0]     │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ main_output (Dense) │ (None, 3)         │        195 │ dropout_12[1][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_1    │ (None, 3)         │         12 │ main_output[1][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_1 (Dense) │ (None, 24)        │         96 │ adversary_norm_1… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_2    │ (None, 24)        │         96 │ adversary_1[0][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_2 (Dense) │ (None, 12)        │        300 │ adversary_norm_2… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_3    │ (None, 12)        │         48 │ adversary_2[0][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_3 (Dense) │ (None, 6)         │         78 │ adversary_norm_3… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_norm_4    │ (None, 6)         │         24 │ adversary_3[0][0] │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ adversary_out       │ (None, 1)         │          7 │ adversary_norm_4… │
│ (Dense)             │                   │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 60,728 (237.22 KB)
 Trainable params: 571 (2.23 KB)
 Non-trainable params: 60,157 (234.99 KB)

2024-09-13 10:55:20,186 - root - DEBUG - Creating the optimizers for the main training and the adversary training.
2024-09-13 10:55:20,213 - root - DEBUG - Gen RAM Free: 19 GB | Used: 9 GB | Util   5% | Total 189 GB
2024-09-13 10:55:20,327 - root - DEBUG - GPU RAM Free: 22776 MB | Used: 252 MB | Util   1% | Total 23028 MB
2024-09-13 10:55:20,328 - root - DEBUG - Compiling the models.
2024-09-13 10:55:20,388 - root - DEBUG - Gen RAM Free: 19 GB | Used: 9 GB | Util   5% | Total 189 GB
2024-09-13 10:55:20,504 - root - DEBUG - GPU RAM Free: 22776 MB | Used: 252 MB | Util   1% | Total 23028 MB
2024-09-13 10:55:20,508 - root - DEBUG - Starting training
2024-09-13 10:55:20,510 - root - INFO - Training Epoch 1 of 3
2024-09-13 10:55:20,514 - root - DEBUG - Running batch 1 (of 10 batches) of epoch 1
2024-09-13 10:55:20,515 - root - DEBUG -   -> Training adversary
2024-09-13 10:55:20,517 - root - DEBUG -   Training adversary 
2024-09-13 10:56:07.251677: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:531] Loaded cuDNN version 8907
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
2024-09-13 10:56:13,003 - root - DEBUG - Gen RAM Free: 17 GB | Used: 11 GB | Util   6% | Total 189 GB
2024-09-13 10:56:13,139 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:56:13,140 - root - DEBUG -   Adversary Loss: 0.7006
2024-09-13 10:56:13,141 - root - DEBUG -   Adversary binary Accuracy: 0.5034
2024-09-13 10:56:13,434 - root - DEBUG -   Training adversary 
2024-09-13 10:56:19,819 - root - DEBUG - Gen RAM Free: 16 GB | Used: 11 GB | Util   7% | Total 189 GB
2024-09-13 10:56:19,935 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:56:19,936 - root - DEBUG -   Adversary Loss: 0.7000
2024-09-13 10:56:19,937 - root - DEBUG -   Adversary binary Accuracy: 0.5041
2024-09-13 10:56:20,164 - root - DEBUG -   -> Training main network
2024-09-13 10:57:19,659 - root - DEBUG - Gen RAM Free: 16 GB | Used: 12 GB | Util   7% | Total 189 GB
2024-09-13 10:57:19,785 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:57:20,176 - root - DEBUG - Running batch 2 (of 10 batches) of epoch 1
2024-09-13 10:57:20,176 - root - DEBUG -   -> Training adversary
2024-09-13 10:57:20,177 - root - DEBUG -   Training adversary 
2024-09-13 10:57:26,514 - root - DEBUG - Gen RAM Free: 16 GB | Used: 12 GB | Util   7% | Total 189 GB
2024-09-13 10:57:26,625 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:57:26,626 - root - DEBUG -   Adversary Loss: 0.6984
2024-09-13 10:57:26,627 - root - DEBUG -   Adversary binary Accuracy: 0.5037
2024-09-13 10:57:26,918 - root - DEBUG -   Training adversary 
2024-09-13 10:57:33,283 - root - DEBUG - Gen RAM Free: 15 GB | Used: 12 GB | Util   7% | Total 189 GB
2024-09-13 10:57:33,387 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:57:33,388 - root - DEBUG -   Adversary Loss: 0.6975
2024-09-13 10:57:33,389 - root - DEBUG -   Adversary binary Accuracy: 0.5039
2024-09-13 10:57:33,700 - root - DEBUG -   -> Training main network
2024-09-13 10:58:05,603 - root - DEBUG - Gen RAM Free: 15 GB | Used: 13 GB | Util   8% | Total 189 GB
2024-09-13 10:58:05,711 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:06,079 - root - DEBUG - Running batch 3 (of 10 batches) of epoch 1
2024-09-13 10:58:06,079 - root - DEBUG -   -> Training adversary
2024-09-13 10:58:06,080 - root - DEBUG -   Training adversary 
2024-09-13 10:58:12,050 - root - DEBUG - Gen RAM Free: 15 GB | Used: 13 GB | Util   8% | Total 189 GB
2024-09-13 10:58:12,155 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:12,156 - root - DEBUG -   Adversary Loss: 0.6967
2024-09-13 10:58:12,157 - root - DEBUG -   Adversary binary Accuracy: 0.5048
2024-09-13 10:58:12,458 - root - DEBUG -   Training adversary 
2024-09-13 10:58:18,778 - root - DEBUG - Gen RAM Free: 14 GB | Used: 13 GB | Util   8% | Total 189 GB
2024-09-13 10:58:18,883 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:18,885 - root - DEBUG -   Adversary Loss: 0.6961
2024-09-13 10:58:18,886 - root - DEBUG -   Adversary binary Accuracy: 0.5058
2024-09-13 10:58:19,220 - root - DEBUG -   -> Training main network
2024-09-13 10:58:25,325 - root - DEBUG - Gen RAM Free: 14 GB | Used: 14 GB | Util   8% | Total 189 GB
2024-09-13 10:58:25,433 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:25,760 - root - DEBUG - Running batch 4 (of 10 batches) of epoch 1
2024-09-13 10:58:25,761 - root - DEBUG -   -> Training adversary
2024-09-13 10:58:25,761 - root - DEBUG -   Training adversary 
2024-09-13 10:58:31,680 - root - DEBUG - Gen RAM Free: 14 GB | Used: 14 GB | Util   8% | Total 189 GB
2024-09-13 10:58:31,785 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:31,787 - root - DEBUG -   Adversary Loss: 0.6989
2024-09-13 10:58:31,787 - root - DEBUG -   Adversary binary Accuracy: 0.5064
2024-09-13 10:58:32,102 - root - DEBUG -   Training adversary 
2024-09-13 10:58:38,432 - root - DEBUG - Gen RAM Free: 13 GB | Used: 14 GB | Util   8% | Total 189 GB
2024-09-13 10:58:38,537 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:38,538 - root - DEBUG -   Adversary Loss: 0.7010
2024-09-13 10:58:38,539 - root - DEBUG -   Adversary binary Accuracy: 0.5064
2024-09-13 10:58:38,842 - root - DEBUG -   -> Training main network
2024-09-13 10:58:45,115 - root - DEBUG - Gen RAM Free: 13 GB | Used: 15 GB | Util   9% | Total 189 GB
2024-09-13 10:58:45,226 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:45,540 - root - DEBUG - Running batch 5 (of 10 batches) of epoch 1
2024-09-13 10:58:45,540 - root - DEBUG -   -> Training adversary
2024-09-13 10:58:45,541 - root - DEBUG -   Training adversary 
2024-09-13 10:58:51,444 - root - DEBUG - Gen RAM Free: 13 GB | Used: 15 GB | Util   9% | Total 189 GB
2024-09-13 10:58:51,556 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:51,557 - root - DEBUG -   Adversary Loss: 0.7010
2024-09-13 10:58:51,558 - root - DEBUG -   Adversary binary Accuracy: 0.5060
2024-09-13 10:58:51,861 - root - DEBUG -   Training adversary 
2024-09-13 10:58:58,207 - root - DEBUG - Gen RAM Free: 12 GB | Used: 15 GB | Util   9% | Total 189 GB
2024-09-13 10:58:58,310 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:58:58,311 - root - DEBUG -   Adversary Loss: 0.7010
2024-09-13 10:58:58,312 - root - DEBUG -   Adversary binary Accuracy: 0.5058
2024-09-13 10:58:58,615 - root - DEBUG -   -> Training main network
2024-09-13 10:59:04,701 - root - DEBUG - Gen RAM Free: 12 GB | Used: 16 GB | Util   9% | Total 189 GB
2024-09-13 10:59:04,809 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:05,122 - root - DEBUG - Running batch 6 (of 10 batches) of epoch 1
2024-09-13 10:59:05,123 - root - DEBUG -   -> Training adversary
2024-09-13 10:59:05,123 - root - DEBUG -   Training adversary 
2024-09-13 10:59:11,033 - root - DEBUG - Gen RAM Free: 11 GB | Used: 16 GB | Util   9% | Total 189 GB
2024-09-13 10:59:11,136 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:11,137 - root - DEBUG -   Adversary Loss: 0.7017
2024-09-13 10:59:11,138 - root - DEBUG -   Adversary binary Accuracy: 0.5061
2024-09-13 10:59:11,442 - root - DEBUG -   Training adversary 
2024-09-13 10:59:17,303 - root - DEBUG - Gen RAM Free: 11 GB | Used: 17 GB | Util  10% | Total 189 GB
2024-09-13 10:59:17,402 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:17,404 - root - DEBUG -   Adversary Loss: 0.7022
2024-09-13 10:59:17,404 - root - DEBUG -   Adversary binary Accuracy: 0.5069
2024-09-13 10:59:17,709 - root - DEBUG -   -> Training main network
2024-09-13 10:59:23,369 - root - DEBUG - Gen RAM Free: 10 GB | Used: 17 GB | Util  10% | Total 189 GB
2024-09-13 10:59:23,474 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:23,783 - root - DEBUG - Running batch 7 (of 10 batches) of epoch 1
2024-09-13 10:59:23,783 - root - DEBUG -   -> Training adversary
2024-09-13 10:59:23,784 - root - DEBUG -   Training adversary 
2024-09-13 10:59:29,340 - root - DEBUG - Gen RAM Free: 10 GB | Used: 18 GB | Util  10% | Total 189 GB
2024-09-13 10:59:29,445 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:29,447 - root - DEBUG -   Adversary Loss: 0.7018
2024-09-13 10:59:29,447 - root - DEBUG -   Adversary binary Accuracy: 0.5073
2024-09-13 10:59:29,754 - root - DEBUG -   Training adversary 
2024-09-13 10:59:35,128 - root - DEBUG - Gen RAM Free: 9 GB | Used: 18 GB | Util  10% | Total 189 GB
2024-09-13 10:59:35,239 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:35,240 - root - DEBUG -   Adversary Loss: 0.7014
2024-09-13 10:59:35,241 - root - DEBUG -   Adversary binary Accuracy: 0.5079
2024-09-13 10:59:35,547 - root - DEBUG -   -> Training main network
2024-09-13 10:59:41,376 - root - DEBUG - Gen RAM Free: 9 GB | Used: 18 GB | Util  11% | Total 189 GB
2024-09-13 10:59:41,476 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:41,793 - root - DEBUG - Running batch 8 (of 10 batches) of epoch 1
2024-09-13 10:59:41,794 - root - DEBUG -   -> Training adversary
2024-09-13 10:59:41,794 - root - DEBUG -   Training adversary 
2024-09-13 10:59:47,294 - root - DEBUG - Gen RAM Free: 8 GB | Used: 19 GB | Util  11% | Total 189 GB
2024-09-13 10:59:47,421 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:47,423 - root - DEBUG -   Adversary Loss: 0.7005
2024-09-13 10:59:47,423 - root - DEBUG -   Adversary binary Accuracy: 0.5092
2024-09-13 10:59:47,744 - root - DEBUG -   Training adversary 
2024-09-13 10:59:53,110 - root - DEBUG - Gen RAM Free: 8 GB | Used: 19 GB | Util  11% | Total 189 GB
2024-09-13 10:59:53,218 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:53,220 - root - DEBUG -   Adversary Loss: 0.6997
2024-09-13 10:59:53,220 - root - DEBUG -   Adversary binary Accuracy: 0.5106
2024-09-13 10:59:53,563 - root - DEBUG -   -> Training main network
2024-09-13 10:59:59,269 - root - DEBUG - Gen RAM Free: 8 GB | Used: 19 GB | Util  11% | Total 189 GB
2024-09-13 10:59:59,380 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 10:59:59,734 - root - DEBUG - Running batch 9 (of 10 batches) of epoch 1
2024-09-13 10:59:59,735 - root - DEBUG -   -> Training adversary
2024-09-13 10:59:59,735 - root - DEBUG -   Training adversary 
2024-09-13 11:00:05,301 - root - DEBUG - Gen RAM Free: 7 GB | Used: 20 GB | Util  11% | Total 189 GB
2024-09-13 11:00:05,408 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:00:05,409 - root - DEBUG -   Adversary Loss: 0.6990
2024-09-13 11:00:05,410 - root - DEBUG -   Adversary binary Accuracy: 0.5123
2024-09-13 11:00:05,716 - root - DEBUG -   Training adversary 
2024-09-13 11:00:11,454 - root - DEBUG - Gen RAM Free: 7 GB | Used: 20 GB | Util  12% | Total 189 GB
2024-09-13 11:00:11,567 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:00:11,568 - root - DEBUG -   Adversary Loss: 0.6984
2024-09-13 11:00:11,569 - root - DEBUG -   Adversary binary Accuracy: 0.5138
2024-09-13 11:00:11,881 - root - DEBUG -   -> Training main network
2024-09-13 11:00:17,708 - root - DEBUG - Gen RAM Free: 7 GB | Used: 21 GB | Util  12% | Total 189 GB
2024-09-13 11:00:17,817 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:00:18,131 - root - DEBUG - Running batch 10 (of 10 batches) of epoch 1
2024-09-13 11:00:18,131 - root - DEBUG -   -> Training adversary
2024-09-13 11:00:18,132 - root - DEBUG -   Training adversary 
2024-09-13 11:00:44,584 - root - DEBUG - Gen RAM Free: 7 GB | Used: 21 GB | Util  12% | Total 189 GB
2024-09-13 11:00:44,705 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:00:44,707 - root - DEBUG -   Adversary Loss: 0.6980
2024-09-13 11:00:44,709 - root - DEBUG -   Adversary binary Accuracy: 0.5156
2024-09-13 11:00:45,067 - root - DEBUG -   Training adversary 
2024-09-13 11:00:50,695 - root - DEBUG - Gen RAM Free: 6 GB | Used: 21 GB | Util  12% | Total 189 GB
2024-09-13 11:00:50,803 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:00:50,805 - root - DEBUG -   Adversary Loss: 0.6976
2024-09-13 11:00:50,805 - root - DEBUG -   Adversary binary Accuracy: 0.5173
2024-09-13 11:00:51,143 - root - DEBUG -   -> Training main network
2024-09-13 11:00:57,296 - root - DEBUG - Gen RAM Free: 6 GB | Used: 22 GB | Util  12% | Total 189 GB
2024-09-13 11:00:57,405 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:00:57,791 - root - DEBUG -   Info for last mini-batch of epoch
2024-09-13 11:00:57,792 - root - DEBUG -   loss: 3.4401
2024-09-13 11:00:57,792 - root - DEBUG -   main_output_loss: 13.9716
2024-09-13 11:00:57,793 - root - DEBUG -   adversary_loss: -7.0054
2024-09-13 11:00:57,793 - root - DEBUG -   Main categorical accuracy: 0.3534722328186035
2024-09-13 11:00:57,794 - root - DEBUG -   Adversary binary accuracy: 0.5204991102218628
2024-09-13 11:00:57,794 - root - DEBUG - End of Epoch Training
2024-09-13 11:01:03,385 - root - INFO -   loss on test dataset: 3.4294
2024-09-13 11:01:03,386 - root - INFO -   main_output_loss on test dataset: 13.6897
2024-09-13 11:01:03,386 - root - INFO -   adversary_loss on test dataset: -7.0106
2024-09-13 11:01:03,387 - root - INFO -   Main categorical accuracy on test dataset: 0.35367855429649353
2024-09-13 11:01:03,387 - root - INFO -   Adversary binary accuracy on test dataset: 0.5208092927932739
2024-09-13 11:01:08,986 - root - DEBUG - Gen RAM Free: 6 GB | Used: 22 GB | Util  12% | Total 189 GB
2024-09-13 11:01:09,099 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:01:09,101 - root - DEBUG - Val Adversary Loss: 0.6978
2024-09-13 11:01:09,102 - root - DEBUG - Val Adversary binary Accuracy: 0.5183
2024-09-13 11:02:08,472 - root - INFO - Start clear session
2024-09-13 11:02:19,738 - root - DEBUG - Plotting Adversary History plots...
2024-09-13 11:02:51,238 - root - DEBUG - Finished Epoch Validation
2024-09-13 11:02:51,239 - root - INFO - Training Epoch 2 of 3
2024-09-13 11:02:51,240 - root - DEBUG - Running batch 1 (of 10 batches) of epoch 2
2024-09-13 11:02:51,240 - root - DEBUG -   -> Training adversary
2024-09-13 11:02:51,241 - root - DEBUG -   Training adversary 
2024-09-13 11:02:58,237 - root - DEBUG - Gen RAM Free: 8 GB | Used: 19 GB | Util  11% | Total 189 GB
2024-09-13 11:02:58,345 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:02:58,347 - root - DEBUG -   Adversary Loss: 0.6977
2024-09-13 11:02:58,347 - root - DEBUG -   Adversary binary Accuracy: 0.5202
2024-09-13 11:02:58,917 - root - DEBUG -   Training adversary 
2024-09-13 11:03:05,345 - root - DEBUG - Gen RAM Free: 8 GB | Used: 20 GB | Util  11% | Total 189 GB
2024-09-13 11:03:05,472 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:05,474 - root - DEBUG -   Adversary Loss: 0.6975
2024-09-13 11:03:05,474 - root - DEBUG -   Adversary binary Accuracy: 0.5221
2024-09-13 11:03:05,839 - root - DEBUG -   -> Training main network
2024-09-13 11:03:12,916 - root - DEBUG - Gen RAM Free: 7 GB | Used: 21 GB | Util  12% | Total 189 GB
2024-09-13 11:03:13,045 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:13,419 - root - DEBUG - Running batch 2 (of 10 batches) of epoch 2
2024-09-13 11:03:13,420 - root - DEBUG -   -> Training adversary
2024-09-13 11:03:13,420 - root - DEBUG -   Training adversary 
2024-09-13 11:03:19,591 - root - DEBUG - Gen RAM Free: 7 GB | Used: 21 GB | Util  12% | Total 189 GB
2024-09-13 11:03:19,699 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:19,701 - root - DEBUG -   Adversary Loss: 0.6972
2024-09-13 11:03:19,701 - root - DEBUG -   Adversary binary Accuracy: 0.5235
2024-09-13 11:03:20,056 - root - DEBUG -   Training adversary 
2024-09-13 11:03:26,200 - root - DEBUG - Gen RAM Free: 6 GB | Used: 21 GB | Util  12% | Total 189 GB
2024-09-13 11:03:26,305 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:26,306 - root - DEBUG -   Adversary Loss: 0.6969
2024-09-13 11:03:26,307 - root - DEBUG -   Adversary binary Accuracy: 0.5252
2024-09-13 11:03:26,658 - root - DEBUG -   -> Training main network
2024-09-13 11:03:33,551 - root - DEBUG - Gen RAM Free: 6 GB | Used: 22 GB | Util  12% | Total 189 GB
2024-09-13 11:03:33,657 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:34,025 - root - DEBUG - Running batch 3 (of 10 batches) of epoch 2
2024-09-13 11:03:34,025 - root - DEBUG -   -> Training adversary
2024-09-13 11:03:34,026 - root - DEBUG -   Training adversary 
2024-09-13 11:03:40,088 - root - DEBUG - Gen RAM Free: 6 GB | Used: 22 GB | Util  12% | Total 189 GB
2024-09-13 11:03:40,192 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:40,194 - root - DEBUG -   Adversary Loss: 0.6965
2024-09-13 11:03:40,195 - root - DEBUG -   Adversary binary Accuracy: 0.5269
2024-09-13 11:03:40,548 - root - DEBUG -   Training adversary 
2024-09-13 11:03:46,939 - root - DEBUG - Gen RAM Free: 6 GB | Used: 22 GB | Util  12% | Total 189 GB
2024-09-13 11:03:47,050 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:47,052 - root - DEBUG -   Adversary Loss: 0.6961
2024-09-13 11:03:47,052 - root - DEBUG -   Adversary binary Accuracy: 0.5285
2024-09-13 11:03:47,433 - root - DEBUG -   -> Training main network
2024-09-13 11:03:54,869 - root - DEBUG - Gen RAM Free: 5 GB | Used: 23 GB | Util  13% | Total 189 GB
2024-09-13 11:03:54,997 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:03:55,457 - root - DEBUG - Running batch 4 (of 10 batches) of epoch 2
2024-09-13 11:03:55,457 - root - DEBUG -   -> Training adversary
2024-09-13 11:03:55,458 - root - DEBUG -   Training adversary 
2024-09-13 11:04:01,735 - root - DEBUG - Gen RAM Free: 4 GB | Used: 23 GB | Util  13% | Total 189 GB
2024-09-13 11:04:01,846 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:01,847 - root - DEBUG -   Adversary Loss: 0.6966
2024-09-13 11:04:01,848 - root - DEBUG -   Adversary binary Accuracy: 0.5298
2024-09-13 11:04:02,251 - root - DEBUG -   Training adversary 
2024-09-13 11:04:08,239 - root - DEBUG - Gen RAM Free: 4 GB | Used: 23 GB | Util  13% | Total 189 GB
2024-09-13 11:04:08,341 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:08,342 - root - DEBUG -   Adversary Loss: 0.6971
2024-09-13 11:04:08,343 - root - DEBUG -   Adversary binary Accuracy: 0.5312
2024-09-13 11:04:08,696 - root - DEBUG -   -> Training main network
2024-09-13 11:04:15,183 - root - DEBUG - Gen RAM Free: 4 GB | Used: 23 GB | Util  13% | Total 189 GB
2024-09-13 11:04:15,293 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:15,660 - root - DEBUG - Running batch 5 (of 10 batches) of epoch 2
2024-09-13 11:04:15,660 - root - DEBUG -   -> Training adversary
2024-09-13 11:04:15,661 - root - DEBUG -   Training adversary 
2024-09-13 11:04:21,396 - root - DEBUG - Gen RAM Free: 4 GB | Used: 24 GB | Util  13% | Total 189 GB
2024-09-13 11:04:21,503 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:21,505 - root - DEBUG -   Adversary Loss: 0.6969
2024-09-13 11:04:21,506 - root - DEBUG -   Adversary binary Accuracy: 0.5327
2024-09-13 11:04:21,861 - root - DEBUG -   Training adversary 
2024-09-13 11:04:27,796 - root - DEBUG - Gen RAM Free: 3 GB | Used: 24 GB | Util  14% | Total 189 GB
2024-09-13 11:04:27,905 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:27,906 - root - DEBUG -   Adversary Loss: 0.6967
2024-09-13 11:04:27,907 - root - DEBUG -   Adversary binary Accuracy: 0.5342
2024-09-13 11:04:28,268 - root - DEBUG -   -> Training main network
2024-09-13 11:04:34,812 - root - DEBUG - Gen RAM Free: 3 GB | Used: 24 GB | Util  14% | Total 189 GB
2024-09-13 11:04:34,923 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:35,298 - root - DEBUG - Running batch 6 (of 10 batches) of epoch 2
2024-09-13 11:04:35,299 - root - DEBUG -   -> Training adversary
2024-09-13 11:04:35,299 - root - DEBUG -   Training adversary 
2024-09-13 11:04:41,060 - root - DEBUG - Gen RAM Free: 3 GB | Used: 25 GB | Util  14% | Total 189 GB
2024-09-13 11:04:41,170 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:41,172 - root - DEBUG -   Adversary Loss: 0.6968
2024-09-13 11:04:41,172 - root - DEBUG -   Adversary binary Accuracy: 0.5356
2024-09-13 11:04:41,529 - root - DEBUG -   Training adversary 
2024-09-13 11:04:47,164 - root - DEBUG - Gen RAM Free: 2 GB | Used: 25 GB | Util  14% | Total 189 GB
2024-09-13 11:04:47,272 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:47,274 - root - DEBUG -   Adversary Loss: 0.6969
2024-09-13 11:04:47,275 - root - DEBUG -   Adversary binary Accuracy: 0.5370
2024-09-13 11:04:47,642 - root - DEBUG -   -> Training main network
2024-09-13 11:04:53,712 - root - DEBUG - Gen RAM Free: 2 GB | Used: 26 GB | Util  14% | Total 189 GB
2024-09-13 11:04:53,838 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:04:54,229 - root - DEBUG - Running batch 7 (of 10 batches) of epoch 2
2024-09-13 11:04:54,229 - root - DEBUG -   -> Training adversary
2024-09-13 11:04:54,230 - root - DEBUG -   Training adversary 
2024-09-13 11:04:59,971 - root - DEBUG - Gen RAM Free: 2 GB | Used: 26 GB | Util  14% | Total 189 GB
2024-09-13 11:05:00,085 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:00,086 - root - DEBUG -   Adversary Loss: 0.6966
2024-09-13 11:05:00,086 - root - DEBUG -   Adversary binary Accuracy: 0.5382
2024-09-13 11:05:00,522 - root - DEBUG -   Training adversary 
2024-09-13 11:05:06,119 - root - DEBUG - Gen RAM Free: 1 GB | Used: 26 GB | Util  15% | Total 189 GB
2024-09-13 11:05:06,223 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:06,224 - root - DEBUG -   Adversary Loss: 0.6962
2024-09-13 11:05:06,225 - root - DEBUG -   Adversary binary Accuracy: 0.5396
2024-09-13 11:05:06,612 - root - DEBUG -   -> Training main network
2024-09-13 11:05:13,089 - root - DEBUG - Gen RAM Free: 1 GB | Used: 27 GB | Util  15% | Total 189 GB
2024-09-13 11:05:13,205 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:13,588 - root - DEBUG - Running batch 8 (of 10 batches) of epoch 2
2024-09-13 11:05:13,589 - root - DEBUG -   -> Training adversary
2024-09-13 11:05:13,589 - root - DEBUG -   Training adversary 
2024-09-13 11:05:19,319 - root - DEBUG - Gen RAM Free: 1 GB | Used: 27 GB | Util  15% | Total 189 GB
2024-09-13 11:05:19,446 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:19,447 - root - DEBUG -   Adversary Loss: 0.6957
2024-09-13 11:05:19,448 - root - DEBUG -   Adversary binary Accuracy: 0.5409
2024-09-13 11:05:19,835 - root - DEBUG -   Training adversary 
2024-09-13 11:05:25,268 - root - DEBUG - Gen RAM Free: 1 GB | Used: 27 GB | Util  15% | Total 189 GB
2024-09-13 11:05:25,381 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:25,382 - root - DEBUG -   Adversary Loss: 0.6951
2024-09-13 11:05:25,383 - root - DEBUG -   Adversary binary Accuracy: 0.5423
2024-09-13 11:05:25,757 - root - DEBUG -   -> Training main network
2024-09-13 11:05:31,815 - root - DEBUG - Gen RAM Free: 1 GB | Used: 28 GB | Util  15% | Total 189 GB
2024-09-13 11:05:31,927 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:32,299 - root - DEBUG - Running batch 9 (of 10 batches) of epoch 2
2024-09-13 11:05:32,299 - root - DEBUG -   -> Training adversary
2024-09-13 11:05:32,300 - root - DEBUG -   Training adversary 
2024-09-13 11:05:37,978 - root - DEBUG - Gen RAM Free: 1 GB | Used: 28 GB | Util  16% | Total 189 GB
2024-09-13 11:05:38,081 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:38,082 - root - DEBUG -   Adversary Loss: 0.6945
2024-09-13 11:05:38,083 - root - DEBUG -   Adversary binary Accuracy: 0.5436
2024-09-13 11:05:38,452 - root - DEBUG -   Training adversary 
2024-09-13 11:05:43,972 - root - DEBUG - Gen RAM Free: 1 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:05:44,076 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:44,077 - root - DEBUG -   Adversary Loss: 0.6940
2024-09-13 11:05:44,078 - root - DEBUG -   Adversary binary Accuracy: 0.5448
2024-09-13 11:05:44,446 - root - DEBUG -   -> Training main network
2024-09-13 11:05:50,412 - root - DEBUG - Gen RAM Free: 2 GB | Used: 28 GB | Util  16% | Total 189 GB
2024-09-13 11:05:50,533 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:50,925 - root - DEBUG - Running batch 10 (of 10 batches) of epoch 2
2024-09-13 11:05:50,926 - root - DEBUG -   -> Training adversary
2024-09-13 11:05:50,927 - root - DEBUG -   Training adversary 
2024-09-13 11:05:56,962 - root - DEBUG - Gen RAM Free: 1 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:05:57,069 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:05:57,071 - root - DEBUG -   Adversary Loss: 0.6935
2024-09-13 11:05:57,071 - root - DEBUG -   Adversary binary Accuracy: 0.5462
2024-09-13 11:05:57,444 - root - DEBUG -   Training adversary 
2024-09-13 11:06:03,397 - root - DEBUG - Gen RAM Free: 1 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:06:03,505 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:06:03,507 - root - DEBUG -   Adversary Loss: 0.6930
2024-09-13 11:06:03,507 - root - DEBUG -   Adversary binary Accuracy: 0.5476
2024-09-13 11:06:03,899 - root - DEBUG -   -> Training main network
2024-09-13 11:06:09,921 - root - DEBUG - Gen RAM Free: 1 GB | Used: 30 GB | Util  16% | Total 189 GB
2024-09-13 11:06:10,023 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:06:10,453 - root - DEBUG -   Info for last mini-batch of epoch
2024-09-13 11:06:10,454 - root - DEBUG -   loss: 4.1683
2024-09-13 11:06:10,454 - root - DEBUG -   main_output_loss: 11.5541
2024-09-13 11:06:10,455 - root - DEBUG -   adversary_loss: -6.9824
2024-09-13 11:06:10,455 - root - DEBUG -   Main categorical accuracy: 0.36554059386253357
2024-09-13 11:06:10,456 - root - DEBUG -   Adversary binary accuracy: 0.5523929595947266
2024-09-13 11:06:10,456 - root - DEBUG - End of Epoch Training
2024-09-13 11:06:16,239 - root - INFO -   loss on test dataset: 4.1772
2024-09-13 11:06:16,239 - root - INFO -   main_output_loss on test dataset: 11.6257
2024-09-13 11:06:16,240 - root - INFO -   adversary_loss on test dataset: -6.9797
2024-09-13 11:06:16,240 - root - INFO -   Main categorical accuracy on test dataset: 0.36560511589050293
2024-09-13 11:06:16,241 - root - INFO -   Adversary binary accuracy on test dataset: 0.5525869727134705
2024-09-13 11:06:21,843 - root - DEBUG - Gen RAM Free: 1 GB | Used: 30 GB | Util  16% | Total 189 GB
2024-09-13 11:06:21,944 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:06:21,945 - root - DEBUG - Val Adversary Loss: 0.6930
2024-09-13 11:06:21,946 - root - DEBUG - Val Adversary binary Accuracy: 0.5484
2024-09-13 11:07:14,598 - root - INFO - Start clear session
2024-09-13 11:07:26,097 - root - DEBUG - Plotting Adversary History plots...
2024-09-13 11:07:58,872 - root - DEBUG - Finished Epoch Validation
2024-09-13 11:07:58,873 - root - INFO - Training Epoch 3 of 3
2024-09-13 11:07:58,874 - root - DEBUG - Running batch 1 (of 10 batches) of epoch 3
2024-09-13 11:07:58,875 - root - DEBUG -   -> Training adversary
2024-09-13 11:07:58,875 - root - DEBUG -   Training adversary 
2024-09-13 11:08:06,164 - root - DEBUG - Gen RAM Free: 1 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:08:06,270 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:06,272 - root - DEBUG -   Adversary Loss: 0.6926
2024-09-13 11:08:06,272 - root - DEBUG -   Adversary binary Accuracy: 0.5497
2024-09-13 11:08:06,909 - root - DEBUG -   Training adversary 
2024-09-13 11:08:13,780 - root - DEBUG - Gen RAM Free: 2 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:08:13,891 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:13,892 - root - DEBUG -   Adversary Loss: 0.6922
2024-09-13 11:08:13,893 - root - DEBUG -   Adversary binary Accuracy: 0.5512
2024-09-13 11:08:14,311 - root - DEBUG -   -> Training main network
2024-09-13 11:08:21,597 - root - DEBUG - Gen RAM Free: 2 GB | Used: 30 GB | Util  16% | Total 189 GB
2024-09-13 11:08:21,720 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:22,120 - root - DEBUG - Running batch 2 (of 10 batches) of epoch 3
2024-09-13 11:08:22,120 - root - DEBUG -   -> Training adversary
2024-09-13 11:08:22,121 - root - DEBUG -   Training adversary 
2024-09-13 11:08:28,564 - root - DEBUG - Gen RAM Free: 2 GB | Used: 30 GB | Util  16% | Total 189 GB
2024-09-13 11:08:28,674 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:28,675 - root - DEBUG -   Adversary Loss: 0.6918
2024-09-13 11:08:28,676 - root - DEBUG -   Adversary binary Accuracy: 0.5522
2024-09-13 11:08:29,072 - root - DEBUG -   Training adversary 
2024-09-13 11:08:35,919 - root - DEBUG - Gen RAM Free: 3 GB | Used: 28 GB | Util  16% | Total 189 GB
2024-09-13 11:08:36,035 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:36,036 - root - DEBUG -   Adversary Loss: 0.6913
2024-09-13 11:08:36,037 - root - DEBUG -   Adversary binary Accuracy: 0.5534
2024-09-13 11:08:36,438 - root - DEBUG -   -> Training main network
2024-09-13 11:08:43,845 - root - DEBUG - Gen RAM Free: 2 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:08:43,954 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:44,367 - root - DEBUG - Running batch 3 (of 10 batches) of epoch 3
2024-09-13 11:08:44,368 - root - DEBUG -   -> Training adversary
2024-09-13 11:08:44,368 - root - DEBUG -   Training adversary 
2024-09-13 11:08:50,711 - root - DEBUG - Gen RAM Free: 2 GB | Used: 29 GB | Util  16% | Total 189 GB
2024-09-13 11:08:50,820 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:50,822 - root - DEBUG -   Adversary Loss: 0.6908
2024-09-13 11:08:50,822 - root - DEBUG -   Adversary binary Accuracy: 0.5545
2024-09-13 11:08:51,223 - root - DEBUG -   Training adversary 
2024-09-13 11:08:57,424 - root - DEBUG - Gen RAM Free: 2 GB | Used: 30 GB | Util  16% | Total 189 GB
2024-09-13 11:08:57,528 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:08:57,529 - root - DEBUG -   Adversary Loss: 0.6903
2024-09-13 11:08:57,530 - root - DEBUG -   Adversary binary Accuracy: 0.5556
2024-09-13 11:08:57,928 - root - DEBUG -   -> Training main network
2024-09-13 11:09:04,789 - root - DEBUG - Gen RAM Free: 2 GB | Used: 30 GB | Util  17% | Total 189 GB
2024-09-13 11:09:04,912 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:05,331 - root - DEBUG - Running batch 4 (of 10 batches) of epoch 3
2024-09-13 11:09:05,331 - root - DEBUG -   -> Training adversary
2024-09-13 11:09:05,332 - root - DEBUG -   Training adversary 
2024-09-13 11:09:11,504 - root - DEBUG - Gen RAM Free: 2 GB | Used: 30 GB | Util  17% | Total 189 GB
2024-09-13 11:09:11,636 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:11,637 - root - DEBUG -   Adversary Loss: 0.6904
2024-09-13 11:09:11,638 - root - DEBUG -   Adversary binary Accuracy: 0.5567
2024-09-13 11:09:12,105 - root - DEBUG -   Training adversary 
2024-09-13 11:09:18,292 - root - DEBUG - Gen RAM Free: 2 GB | Used: 31 GB | Util  17% | Total 189 GB
2024-09-13 11:09:18,399 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:18,400 - root - DEBUG -   Adversary Loss: 0.6905
2024-09-13 11:09:18,401 - root - DEBUG -   Adversary binary Accuracy: 0.5578
2024-09-13 11:09:18,808 - root - DEBUG -   -> Training main network
2024-09-13 11:09:25,807 - root - DEBUG - Gen RAM Free: 2 GB | Used: 30 GB | Util  17% | Total 189 GB
2024-09-13 11:09:25,923 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:26,327 - root - DEBUG - Running batch 5 (of 10 batches) of epoch 3
2024-09-13 11:09:26,327 - root - DEBUG -   -> Training adversary
2024-09-13 11:09:26,328 - root - DEBUG -   Training adversary 
2024-09-13 11:09:32,448 - root - DEBUG - Gen RAM Free: 2 GB | Used: 31 GB | Util  17% | Total 189 GB
2024-09-13 11:09:32,551 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:32,552 - root - DEBUG -   Adversary Loss: 0.6902
2024-09-13 11:09:32,553 - root - DEBUG -   Adversary binary Accuracy: 0.5589
2024-09-13 11:09:32,976 - root - DEBUG -   Training adversary 
2024-09-13 11:09:38,848 - root - DEBUG - Gen RAM Free: 2 GB | Used: 32 GB | Util  18% | Total 189 GB
2024-09-13 11:09:38,950 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:38,952 - root - DEBUG -   Adversary Loss: 0.6899
2024-09-13 11:09:38,953 - root - DEBUG -   Adversary binary Accuracy: 0.5599
2024-09-13 11:09:39,362 - root - DEBUG -   -> Training main network
2024-09-13 11:09:45,613 - root - DEBUG - Gen RAM Free: 2 GB | Used: 31 GB | Util  17% | Total 189 GB
2024-09-13 11:09:45,723 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:46,130 - root - DEBUG - Running batch 6 (of 10 batches) of epoch 3
2024-09-13 11:09:46,131 - root - DEBUG -   -> Training adversary
2024-09-13 11:09:46,132 - root - DEBUG -   Training adversary 
2024-09-13 11:09:51,841 - root - DEBUG - Gen RAM Free: 2 GB | Used: 32 GB | Util  18% | Total 189 GB
2024-09-13 11:09:51,948 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:51,949 - root - DEBUG -   Adversary Loss: 0.6898
2024-09-13 11:09:51,950 - root - DEBUG -   Adversary binary Accuracy: 0.5610
2024-09-13 11:09:52,356 - root - DEBUG -   Training adversary 
2024-09-13 11:09:58,042 - root - DEBUG - Gen RAM Free: 2 GB | Used: 32 GB | Util  18% | Total 189 GB
2024-09-13 11:09:58,147 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:09:58,149 - root - DEBUG -   Adversary Loss: 0.6897
2024-09-13 11:09:58,149 - root - DEBUG -   Adversary binary Accuracy: 0.5620
2024-09-13 11:09:58,553 - root - DEBUG -   -> Training main network
2024-09-13 11:10:04,874 - root - DEBUG - Gen RAM Free: 2 GB | Used: 33 GB | Util  18% | Total 189 GB
2024-09-13 11:10:05,002 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:05,429 - root - DEBUG - Running batch 7 (of 10 batches) of epoch 3
2024-09-13 11:10:05,429 - root - DEBUG -   -> Training adversary
2024-09-13 11:10:05,430 - root - DEBUG -   Training adversary 
2024-09-13 11:10:11,175 - root - DEBUG - Gen RAM Free: 2 GB | Used: 33 GB | Util  18% | Total 189 GB
2024-09-13 11:10:11,279 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:11,281 - root - DEBUG -   Adversary Loss: 0.6893
2024-09-13 11:10:11,282 - root - DEBUG -   Adversary binary Accuracy: 0.5630
2024-09-13 11:10:11,695 - root - DEBUG -   Training adversary 
2024-09-13 11:10:17,276 - root - DEBUG - Gen RAM Free: 2 GB | Used: 33 GB | Util  18% | Total 189 GB
2024-09-13 11:10:17,388 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:17,389 - root - DEBUG -   Adversary Loss: 0.6889
2024-09-13 11:10:17,390 - root - DEBUG -   Adversary binary Accuracy: 0.5640
2024-09-13 11:10:17,845 - root - DEBUG -   -> Training main network
2024-09-13 11:10:23,845 - root - DEBUG - Gen RAM Free: 2 GB | Used: 33 GB | Util  18% | Total 189 GB
2024-09-13 11:10:23,955 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:24,383 - root - DEBUG - Running batch 8 (of 10 batches) of epoch 3
2024-09-13 11:10:24,383 - root - DEBUG -   -> Training adversary
2024-09-13 11:10:24,384 - root - DEBUG -   Training adversary 
2024-09-13 11:10:30,101 - root - DEBUG - Gen RAM Free: 2 GB | Used: 34 GB | Util  19% | Total 189 GB
2024-09-13 11:10:30,216 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:30,217 - root - DEBUG -   Adversary Loss: 0.6883
2024-09-13 11:10:30,218 - root - DEBUG -   Adversary binary Accuracy: 0.5651
2024-09-13 11:10:30,631 - root - DEBUG -   Training adversary 
2024-09-13 11:10:36,303 - root - DEBUG - Gen RAM Free: 2 GB | Used: 34 GB | Util  19% | Total 189 GB
2024-09-13 11:10:36,410 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:36,411 - root - DEBUG -   Adversary Loss: 0.6877
2024-09-13 11:10:36,412 - root - DEBUG -   Adversary binary Accuracy: 0.5661
2024-09-13 11:10:36,824 - root - DEBUG -   -> Training main network
2024-09-13 11:10:42,948 - root - DEBUG - Gen RAM Free: 2 GB | Used: 35 GB | Util  19% | Total 189 GB
2024-09-13 11:10:43,060 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:43,485 - root - DEBUG - Running batch 9 (of 10 batches) of epoch 3
2024-09-13 11:10:43,485 - root - DEBUG -   -> Training adversary
2024-09-13 11:10:43,486 - root - DEBUG -   Training adversary 
2024-09-13 11:10:49,362 - root - DEBUG - Gen RAM Free: 2 GB | Used: 35 GB | Util  19% | Total 189 GB
2024-09-13 11:10:49,465 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:49,466 - root - DEBUG -   Adversary Loss: 0.6872
2024-09-13 11:10:49,467 - root - DEBUG -   Adversary binary Accuracy: 0.5670
2024-09-13 11:10:49,879 - root - DEBUG -   Training adversary 
2024-09-13 11:10:55,504 - root - DEBUG - Gen RAM Free: 2 GB | Used: 35 GB | Util  20% | Total 189 GB
2024-09-13 11:10:55,628 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:10:55,629 - root - DEBUG -   Adversary Loss: 0.6866
2024-09-13 11:10:55,630 - root - DEBUG -   Adversary binary Accuracy: 0.5680
2024-09-13 11:10:56,049 - root - DEBUG -   -> Training main network
2024-09-13 11:11:02,180 - root - DEBUG - Gen RAM Free: 2 GB | Used: 36 GB | Util  20% | Total 189 GB
2024-09-13 11:11:02,301 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:11:02,732 - root - DEBUG - Running batch 10 (of 10 batches) of epoch 3
2024-09-13 11:11:02,733 - root - DEBUG -   -> Training adversary
2024-09-13 11:11:02,734 - root - DEBUG -   Training adversary 
2024-09-13 11:11:08,622 - root - DEBUG - Gen RAM Free: 2 GB | Used: 36 GB | Util  20% | Total 189 GB
2024-09-13 11:11:08,726 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:11:08,727 - root - DEBUG -   Adversary Loss: 0.6862
2024-09-13 11:11:08,728 - root - DEBUG -   Adversary binary Accuracy: 0.5691
2024-09-13 11:11:09,132 - root - DEBUG -   Training adversary 
2024-09-13 11:11:14,933 - root - DEBUG - Gen RAM Free: 2 GB | Used: 36 GB | Util  20% | Total 189 GB
2024-09-13 11:11:15,036 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:11:15,038 - root - DEBUG -   Adversary Loss: 0.6856
2024-09-13 11:11:15,039 - root - DEBUG -   Adversary binary Accuracy: 0.5701
2024-09-13 11:11:15,446 - root - DEBUG -   -> Training main network
2024-09-13 11:11:21,541 - root - DEBUG - Gen RAM Free: 2 GB | Used: 37 GB | Util  20% | Total 189 GB
2024-09-13 11:11:21,662 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:11:22,178 - root - DEBUG -   Info for last mini-batch of epoch
2024-09-13 11:11:22,179 - root - DEBUG -   loss: 7.4100
2024-09-13 11:11:22,179 - root - DEBUG -   main_output_loss: 13.5028
2024-09-13 11:11:22,180 - root - DEBUG -   adversary_loss: -6.9177
2024-09-13 11:11:22,180 - root - DEBUG -   Main categorical accuracy: 0.3814493715763092
2024-09-13 11:11:22,181 - root - DEBUG -   Adversary binary accuracy: 0.5739631056785583
2024-09-13 11:11:22,182 - root - DEBUG - End of Epoch Training
2024-09-13 11:11:28,031 - root - INFO -   loss on test dataset: 7.4187
2024-09-13 11:11:28,032 - root - INFO -   main_output_loss on test dataset: 13.5959
2024-09-13 11:11:28,032 - root - INFO -   adversary_loss on test dataset: -6.9136
2024-09-13 11:11:28,033 - root - INFO -   Main categorical accuracy on test dataset: 0.3814701437950134
2024-09-13 11:11:28,033 - root - INFO -   Adversary binary accuracy on test dataset: 0.5741444826126099
2024-09-13 11:11:33,707 - root - DEBUG - Gen RAM Free: 2 GB | Used: 37 GB | Util  20% | Total 189 GB
2024-09-13 11:11:33,812 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:11:33,813 - root - DEBUG - Val Adversary Loss: 0.6855
2024-09-13 11:11:33,814 - root - DEBUG - Val Adversary binary Accuracy: 0.5708
2024-09-13 11:12:26,237 - root - INFO - Start clear session
2024-09-13 11:12:38,044 - root - DEBUG - Plotting Adversary History plots...
2024-09-13 11:13:10,295 - root - DEBUG - Finished Epoch Validation
2024-09-13 11:13:10,295 - root - INFO - Finished training
2024-09-13 11:13:10,296 - root - DEBUG - Evaluating model...
2024-09-13 11:14:02,494 - root - INFO - mH: 60.0, mS: 5.0, Eff: 0.41304347826086957
2024-09-13 11:14:02,497 - root - INFO - mH: 60.0, mS: 15.0, Eff: 0.34782608695652173
2024-09-13 11:14:02,500 - root - INFO - mH: 125.0, mS: 5.0, Eff: 0.25984251968503935
2024-09-13 11:14:02,503 - root - INFO - mH: 125.0, mS: 15.0, Eff: 0.26956521739130435
2024-09-13 11:14:02,507 - root - INFO - mH: 125.0, mS: 35.0, Eff: 0.33191489361702126
2024-09-13 11:14:02,510 - root - INFO - mH: 125.0, mS: 55.0, Eff: 0.2608695652173913
2024-09-13 11:14:02,513 - root - INFO - mH: 200.0, mS: 50.0, Eff: 0.26
2024-09-13 11:14:02,516 - root - INFO - mH: 400.0, mS: 100.0, Eff: 0.19047619047619047
2024-09-13 11:14:02,519 - root - INFO - mH: 600.0, mS: 50.0, Eff: 0.140625
2024-09-13 11:14:02,522 - root - INFO - mH: 600.0, mS: 150.0, Eff: 0.2868217054263566
2024-09-13 11:14:02,525 - root - INFO - mH: 600.0, mS: 275.0, Eff: 0.21393034825870647
2024-09-13 11:14:02,528 - root - INFO - mH: 1000.0, mS: 50.0, Eff: 0.1951219512195122
2024-09-13 11:14:02,531 - root - INFO - mH: 1000.0, mS: 275.0, Eff: 0.15328467153284672
2024-09-13 11:14:02,534 - root - INFO - mH: 1000.0, mS: 475.0, Eff: 0.1598360655737705
2024-09-13 11:14:04,899 - root - INFO - mH: 60.0, mS: 5.0, False positive: 0.20930232558139536
2024-09-13 11:14:04,903 - root - INFO - mH: 60.0, mS: 15.0, False positive: 0.21568627450980393
2024-09-13 11:14:04,906 - root - INFO - mH: 125.0, mS: 5.0, False positive: 0.2648401826484018
2024-09-13 11:14:04,909 - root - INFO - mH: 125.0, mS: 15.0, False positive: 0.2828282828282828
2024-09-13 11:14:04,912 - root - INFO - mH: 125.0, mS: 35.0, False positive: 0.263254113345521
2024-09-13 11:14:04,915 - root - INFO - mH: 125.0, mS: 55.0, False positive: 0.2874617737003058
2024-09-13 11:14:04,918 - root - INFO - mH: 200.0, mS: 50.0, False positive: 0.2831858407079646
2024-09-13 11:14:04,921 - root - INFO - mH: 400.0, mS: 100.0, False positive: 0.23846153846153847
2024-09-13 11:14:04,924 - root - INFO - mH: 600.0, mS: 50.0, False positive: 0.234375
2024-09-13 11:14:04,927 - root - INFO - mH: 600.0, mS: 150.0, False positive: 0.29553264604810997
2024-09-13 11:14:04,930 - root - INFO - mH: 600.0, mS: 275.0, False positive: 0.25517241379310346
2024-09-13 11:14:04,934 - root - INFO - mH: 1000.0, mS: 50.0, False positive: 0.2648648648648649
2024-09-13 11:14:04,937 - root - INFO - mH: 1000.0, mS: 275.0, False positive: 0.23711340206185566
2024-09-13 11:14:04,940 - root - INFO - mH: 1000.0, mS: 475.0, False positive: 0.3037300177619893
2024-09-13 11:14:50,496 - root - DEBUG - Gen RAM Free: 2 GB | Used: 36 GB | Util  20% | Total 189 GB
2024-09-13 11:14:50,613 - root - DEBUG - GPU RAM Free: 5296 MB | Used: 17732 MB | Util  77% | Total 23028 MB
2024-09-13 11:14:50,614 - root - INFO - ROC area under curve: 0.344
2024-09-13 11:14:50,615 - root - INFO - Max S over Root B: 28.706
Filename: /data/fye/CalRatioTrainer/cal_ratio_trainer/training/deepJet_train_keras.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   243   2062.8 MiB   2062.8 MiB           1   @profile
   244                                         def build_train_evaluate_model(
   245                                             constit_input: ModelInput,
   246                                             track_input: ModelInput,
   247                                             MSeg_input: ModelInput,
   248                                             jet_input: JetInput,
   249                                             X_train: pd.DataFrame,
   250                                             X_test: pd.DataFrame,
   251                                             y_train_df: pd.DataFrame,
   252                                             y_test_df: pd.DataFrame,
   253                                             mcWeights_train: pd.Series,
   254                                             mcWeights_test: pd.Series,
   255                                             weights_train: pd.Series,
   256                                             weights_test: pd.Series,
   257                                             Z_test: pd.DataFrame,
   258                                             Z_train: pd.DataFrame,
   259                                             constit_input_adversary: ModelInput,
   260                                             track_input_adversary: ModelInput,
   261                                             MSeg_input_adversary: ModelInput,
   262                                             jet_input_adversary: JetInput,
   263                                             X_train_adversary: pd.DataFrame,
   264                                             X_test_adversary: pd.DataFrame,
   265                                             y_train_adversary: pd.DataFrame,
   266                                             y_test_adversary_df: pd.DataFrame,
   267                                             mcWeights_train_adversary: pd.Series,
   268                                             mcWeights_test_adversary: pd.Series,
   269                                             weights_train_adversary: pd.Series,
   270                                             weights_test_adversary: pd.Series,
   271                                             Z_test_adversary: pd.DataFrame,
   272                                             Z_train_adversary: pd.DataFrame,
   273                                             plt_model: bool,
   274                                             dir_name: Path,
   275                                             eval_object: evaluationObject,
   276                                             training_params: TrainingConfig,
   277                                         ) -> float:
   278                                             """
   279                                             This method has the following steps:
   280                                                 - Prepares train, test, and validate data
   281                                                 - Builds model architecture
   282                                                 - Does model training
   283                                                 - Does model evaluation
   284                                             :return: ROC area under curve metric, and model accuracy metric
   285                                         
   286                                             TODO: Note that we have the model, and then the adversary, with almost
   287                                                   identical arguments. Feels like we should be able to organize
   288                                                   this a bit better than a long list of arguments like this!
   289                                             """
   290                                             # Save the training parameters as a yaml file.
   291   2062.8 MiB      0.0 MiB           2       with (dir_name / "training_params.yaml").open("w") as o:
   292   2062.8 MiB      0.0 MiB           1           yaml.dump(training_params.dict(), o)
   293                                         
   294                                             # Divide testing set into epoch-by-epoch validation and final evaluation sets
   295                                             # for the main data and the adversary.
   296   2063.2 MiB      0.0 MiB           1       (
   297   2063.2 MiB      0.0 MiB           1           X_test,
   298   2063.2 MiB      0.0 MiB           1           X_val,
   299   2063.2 MiB      0.0 MiB           1           y_test,
   300   2063.2 MiB      0.0 MiB           1           y_val,
   301   2063.2 MiB      0.0 MiB           1           weights_test,
   302   2063.2 MiB      0.0 MiB           1           weights_val,
   303   2063.2 MiB      0.0 MiB           1           mcWeights_test,
   304   2063.2 MiB      0.0 MiB           1           mcWeights_val,
   305   2063.2 MiB      0.0 MiB           1           Z_test,
   306   2063.2 MiB      0.0 MiB           1           Z_val,
   307   2063.2 MiB      0.4 MiB           2       ) = train_test_split(
   308   2062.8 MiB      0.0 MiB           1           X_test,
   309   2062.8 MiB      0.0 MiB           1           y_test_df,
   310   2062.8 MiB      0.0 MiB           1           weights_test,
   311   2062.8 MiB      0.0 MiB           1           mcWeights_test,
   312   2062.8 MiB      0.0 MiB           1           Z_test,
   313   2062.8 MiB      0.0 MiB           1           test_size=0.5,
   314                                             )
   315   2063.2 MiB      0.0 MiB           1       (
   316   2063.2 MiB      0.0 MiB           1           X_test_adversary,
   317   2063.2 MiB      0.0 MiB           1           X_val_adversary,
   318   2063.2 MiB      0.0 MiB           1           y_test_adversary,
   319   2063.2 MiB      0.0 MiB           1           y_val_adversary,
   320   2063.2 MiB      0.0 MiB           1           weights_test_adversary,
   321   2063.2 MiB      0.0 MiB           1           weights_val_adversary,
   322   2063.2 MiB      0.0 MiB           1           mcWeights_test_adversary,
   323   2063.2 MiB      0.0 MiB           1           mcWeights_val_adversary,
   324   2063.2 MiB      0.0 MiB           1           Z_test_adversary,
   325   2063.2 MiB      0.0 MiB           1           Z_val_adversary,
   326   2063.2 MiB      0.0 MiB           2       ) = train_test_split(
   327   2063.2 MiB      0.0 MiB           1           X_test_adversary,
   328   2063.2 MiB      0.0 MiB           1           y_test_adversary_df,
   329   2063.2 MiB      0.0 MiB           1           weights_test_adversary,
   330   2063.2 MiB      0.0 MiB           1           mcWeights_test_adversary,
   331   2063.2 MiB      0.0 MiB           1           Z_test_adversary,
   332   2063.2 MiB      0.0 MiB           1           test_size=0.5,
   333                                             )
   334                                         
   335                                             # Save to a file
   336   2063.2 MiB      0.0 MiB           1       logging.debug(f"Writing out test data to {dir_name.parent/'y_test.npz'}")
   337   2063.2 MiB      0.0 MiB           1       y_test.to_pickle(dir_name.parent / "y_test.pkl")
   338   2063.2 MiB      0.0 MiB           1       Z_test.to_pickle(dir_name.parent / "Z_test.pkl")
   339                                         
   340   2063.2 MiB      0.0 MiB           1       low_mass = training_params.include_low_mass
   341   2063.2 MiB      0.0 MiB           1       high_mass = training_params.include_high_mass
   342                                             # TODO: these checks on not none are a mess - kill them
   343                                             # and replace with better model than we currently have.
   344   2063.2 MiB      0.0 MiB           1       assert low_mass is not None
   345   2063.2 MiB      0.0 MiB           1       assert high_mass is not None
   346   2063.2 MiB      0.0 MiB           1       (
   347   2063.2 MiB      0.0 MiB           1           X_train,
   348   2063.2 MiB      0.0 MiB           1           y_train_1,
   349   2063.2 MiB      0.0 MiB           1           Z_train,
   350   2063.2 MiB      0.0 MiB           1           weights_train,
   351   2063.2 MiB      0.0 MiB           1           mcWeights_train,
   352   2063.2 MiB      0.0 MiB           2       ) = low_or_high_pt_selection_train(
   353   2063.2 MiB      0.0 MiB           1           X_train,
   354   2063.2 MiB      0.0 MiB           1           y_train_df,
   355   2063.2 MiB      0.0 MiB           1           weights_train,
   356   2063.2 MiB      0.0 MiB           1           mcWeights_train,
   357   2063.2 MiB      0.0 MiB           1           Z_train,
   358   2063.2 MiB      0.0 MiB           1           low_mass,
   359   2063.2 MiB      0.0 MiB           1           high_mass,
   360                                             )
   361                                         
   362   2063.2 MiB      0.0 MiB           2       X_val, y_val, Z_val, weights_val, mcWeights_val = low_or_high_pt_selection_train(
   363   2063.2 MiB      0.0 MiB           1           X_val,
   364   2063.2 MiB      0.0 MiB           1           y_val,
   365   2063.2 MiB      0.0 MiB           1           weights_val,
   366   2063.2 MiB      0.0 MiB           1           mcWeights_val,
   367   2063.2 MiB      0.0 MiB           1           Z_val,
   368   2063.2 MiB      0.0 MiB           1           low_mass,
   369   2063.2 MiB      0.0 MiB           1           high_mass,
   370                                             )
   371                                             assert (
   372   2063.2 MiB      0.0 MiB           1           len(X_val) > 0 and len(y_val) > 0
   373                                             ), "low/high pt selection has eliminated all data"
   374                                         
   375   2831.9 MiB      0.0 MiB           1       (
   376   2831.9 MiB      0.0 MiB           1           X_test_MSeg,
   377   2831.9 MiB      0.0 MiB           1           X_test_MSeg_adversary,
   378   2831.9 MiB      0.0 MiB           1           X_test_constit,
   379   2831.9 MiB      0.0 MiB           1           X_test_constit_adversary,
   380   2831.9 MiB      0.0 MiB           1           X_test_jet,
   381   2831.9 MiB      0.0 MiB           1           X_test_jet_adversary,
   382   2831.9 MiB      0.0 MiB           1           X_test_track,
   383   2831.9 MiB      0.0 MiB           1           X_test_track_adversary,
   384   2831.9 MiB      0.0 MiB           1           X_train_MSeg,
   385   2831.9 MiB      0.0 MiB           1           X_train_MSeg_adversary,
   386   2831.9 MiB      0.0 MiB           1           X_train_constit,
   387   2831.9 MiB      0.0 MiB           1           X_train_constit_adversary,
   388   2831.9 MiB      0.0 MiB           1           X_train_jet,
   389   2831.9 MiB      0.0 MiB           1           X_train_jet_adversary,
   390   2831.9 MiB      0.0 MiB           1           X_train_track,
   391   2831.9 MiB      0.0 MiB           1           X_train_track_adversary,
   392   2831.9 MiB      0.0 MiB           1           X_val_MSeg,
   393   2831.9 MiB      0.0 MiB           1           X_val_MSeg_adversary,
   394   2831.9 MiB      0.0 MiB           1           X_val_constit,
   395   2831.9 MiB      0.0 MiB           1           X_val_constit_adversary,
   396   2831.9 MiB      0.0 MiB           1           X_val_jet,
   397   2831.9 MiB      0.0 MiB           1           X_val_jet_adversary,
   398   2831.9 MiB      0.0 MiB           1           X_val_track,
   399   2831.9 MiB      0.0 MiB           1           X_val_track_adversary,
   400   2831.9 MiB      0.0 MiB           1           y_train,
   401   2831.9 MiB      0.0 MiB           1           y_val,
   402   2831.9 MiB    768.7 MiB           2       ) = prep_input_for_keras(
   403   2063.2 MiB      0.0 MiB           1           MSeg_input,
   404   2063.2 MiB      0.0 MiB           1           X_test,
   405   2063.2 MiB      0.0 MiB           1           X_test_adversary,
   406   2063.2 MiB      0.0 MiB           1           X_train,
   407   2063.2 MiB      0.0 MiB           1           X_train_adversary,
   408   2063.2 MiB      0.0 MiB           1           X_val,
   409   2063.2 MiB      0.0 MiB           1           X_val_adversary,
   410   2063.2 MiB      0.0 MiB           1           Z_test,
   411   2063.2 MiB      0.0 MiB           1           Z_test_adversary,
   412   2063.2 MiB      0.0 MiB           1           Z_train,
   413   2063.2 MiB      0.0 MiB           1           Z_train_adversary,
   414   2063.2 MiB      0.0 MiB           1           Z_val,
   415   2063.2 MiB      0.0 MiB           1           Z_val_adversary,
   416   2063.2 MiB      0.0 MiB           1           constit_input,
   417   2063.2 MiB      0.0 MiB           1           jet_input,
   418   2063.2 MiB      0.0 MiB           1           track_input,
   419   2063.2 MiB      0.0 MiB           1           y_train_1,
   420   2063.2 MiB      0.0 MiB           1           y_val,
   421                                             )
   422                                         
   423   2831.9 MiB      0.0 MiB           1       logging.debug("Done preparing data for model")
   424                                         
   425                                             # Setup training inputs, outputs, and weights
   426   2831.9 MiB      0.0 MiB           1       x_to_train = [X_train_constit, X_train_track, X_train_MSeg, X_train_jet.values]
   427   2831.9 MiB      0.0 MiB           1       x_to_adversary = [
   428   2831.9 MiB      0.0 MiB           1           X_train_constit_adversary,
   429   2831.9 MiB      0.0 MiB           1           X_train_track_adversary,
   430   2831.9 MiB      0.0 MiB           1           X_train_MSeg_adversary,
   431   2831.9 MiB      0.0 MiB           1           X_train_jet_adversary.values,
   432                                             ]
   433   2831.9 MiB      0.0 MiB           1       y_to_train = [y_train, y_train, y_train, y_train, y_train, y_train]
   434   2831.9 MiB      0.0 MiB           1       y_to_train_adversary = [y_train_adversary]
   435   2831.9 MiB      0.0 MiB           1       weights_to_train = [
   436   2831.9 MiB      0.0 MiB           1           weights_train.values,
   437   2831.9 MiB      0.0 MiB           1           weights_train.values,
   438   2831.9 MiB      0.0 MiB           1           weights_train.values,
   439   2831.9 MiB      0.0 MiB           1           weights_train.values,
   440   2831.9 MiB      0.0 MiB           1           weights_train.values,
   441   2831.9 MiB      0.0 MiB           1           weights_train.values,
   442                                             ]
   443                                         
   444                                             # Setup validation inputs, outputs, and weights
   445   2831.9 MiB      0.0 MiB           1       x_to_validate = [X_val_constit, X_val_track, X_val_MSeg, X_val_jet.values]
   446   2831.9 MiB      0.0 MiB           1       x_to_validate_adv = [
   447   2831.9 MiB      0.0 MiB           1           X_val_constit_adversary,
   448   2831.9 MiB      0.0 MiB           1           X_val_track_adversary,
   449   2831.9 MiB      0.0 MiB           1           X_val_MSeg_adversary,
   450   2831.9 MiB      0.0 MiB           1           X_val_jet_adversary.values,
   451                                             ]
   452   2831.9 MiB      0.0 MiB           1       y_to_validate = [y_val, y_val, y_val, y_val, y_val, y_val]
   453   2831.9 MiB      0.0 MiB           1       y_to_validate_adv = [y_val_adversary]
   454   2831.9 MiB      0.0 MiB           1       weights_to_validate = [
   455   2831.9 MiB      0.0 MiB           1           weights_val.values,
   456   2831.9 MiB      0.0 MiB           1           weights_val.values,
   457   2831.9 MiB      0.0 MiB           1           weights_val.values,
   458   2831.9 MiB      0.0 MiB           1           weights_val.values,
   459   2831.9 MiB      0.0 MiB           1           weights_val.values,
   460   2831.9 MiB      0.0 MiB           1           weights_val.values,
   461                                             ]
   462                                         
   463                                             # Setup testing input, outputs, and weights
   464                                             # Cache them to disk for later re-use.
   465   2831.9 MiB      0.0 MiB           1       x_to_test = [X_test_constit, X_test_track, X_test_MSeg, X_test_jet.values]
   466   2831.9 MiB      0.0 MiB           1       x_to_test_adversary = [
   467   2831.9 MiB      0.0 MiB           1           X_test_constit_adversary,
   468   2831.9 MiB      0.0 MiB           1           X_test_track_adversary,
   469   2831.9 MiB      0.0 MiB           1           X_test_MSeg_adversary,
   470   2831.9 MiB      0.0 MiB           1           X_test_jet_adversary.values,
   471                                             ]
   472   2831.9 MiB      0.0 MiB           1       weights_to_test = [
   473   2831.9 MiB      0.0 MiB           1           weights_test.values,
   474   2831.9 MiB      0.0 MiB           1           weights_test.values,
   475   2831.9 MiB      0.0 MiB           1           weights_test.values,
   476   2831.9 MiB      0.0 MiB           1           weights_test.values,
   477   2831.9 MiB      0.0 MiB           1           weights_test.values,
   478   2831.9 MiB      0.0 MiB           1           weights_test.values,
   479                                             ]
   480   2831.9 MiB      0.0 MiB           1       logging.debug(f"Writing out test data to {dir_name.parent/'x_to_test.npz'}")
   481   2831.9 MiB      0.0 MiB           1       np.savez_compressed(dir_name.parent / "x_to_test.npz", *x_to_test)
   482   2831.9 MiB      0.0 MiB           1       np.savez_compressed(dir_name.parent / "weights_to_test.npz", *weights_to_test)
   483   2831.9 MiB      0.0 MiB           1       check_memory()
   484                                         
   485                                             # Now to setup ML architecture
   486   2831.9 MiB      0.0 MiB           1       logging.debug("Setting up model architecture...")
   487   3206.0 MiB      0.0 MiB           1       (
   488   3206.0 MiB      0.0 MiB           1           original_model,
   489   3206.0 MiB      0.0 MiB           1           discriminator_model,
   490   3206.0 MiB      0.0 MiB           1           discriminator_out,
   491   3206.0 MiB      0.0 MiB           1           final_model,
   492   3206.0 MiB    374.1 MiB           2       ) = setup_model_architecture(
   493   2831.9 MiB      0.0 MiB           1           constit_input,
   494   2831.9 MiB      0.0 MiB           1           track_input,
   495   2831.9 MiB      0.0 MiB           1           MSeg_input,
   496   2831.9 MiB      0.0 MiB           1           jet_input,
   497   2831.9 MiB      0.0 MiB           1           X_train_constit,
   498   2831.9 MiB      0.0 MiB           1           X_train_track,
   499   2831.9 MiB      0.0 MiB           1           X_train_MSeg,
   500   2831.9 MiB      0.0 MiB           1           X_train_jet,
   501   2831.9 MiB      0.0 MiB           1           training_params,
   502                                             )
   503   3206.0 MiB      0.0 MiB           1       check_memory()
   504                                         
   505                                             # Save model architecture
   506   3209.6 MiB      3.6 MiB           1       original_model.save(dir_name / "keras" / "model.keras")
   507   3209.9 MiB      0.3 MiB           1       final_model.save(dir_name / "keras" / "final_model.keras") 
   508   3209.9 MiB      0.0 MiB           1       discriminator_model.save(dir_name / "keras" / "discriminator_model.keras") 
   509   3209.9 MiB      0.0 MiB           1       discriminator_model.save_weights(dir_name / "keras" / "initial_discriminator_model.weights.h5")
   510                                         
   511   3210.7 MiB      0.0 MiB           1       (
   512   3210.7 MiB      0.0 MiB           1           num_splits,
   513   3210.7 MiB      0.0 MiB           1           small_mcWeights_val_adversary,
   514   3210.7 MiB      0.0 MiB           1           small_weights_train_adversary,
   515   3210.7 MiB      0.0 MiB           1           small_weights_val_adversary,
   516   3210.7 MiB      0.0 MiB           1           small_x_to_adversary_split,
   517   3210.7 MiB      0.0 MiB           1           small_x_val_adversary,
   518   3210.7 MiB      0.0 MiB           1           small_y_to_train_adversary_0,
   519   3210.7 MiB      0.0 MiB           1           small_y_val_adversary,
   520   3210.7 MiB      0.0 MiB           1           weights_to_train_0,
   521   3210.7 MiB      0.0 MiB           1           weights_to_validate_0,
   522   3210.7 MiB      0.0 MiB           1           weights_train_adversary_s,
   523   3210.7 MiB      0.0 MiB           1           weights_val_adversary_split,
   524   3210.7 MiB      0.0 MiB           1           x_to_adversary_split,
   525   3210.7 MiB      0.0 MiB           1           x_to_train_split,
   526   3210.7 MiB      0.0 MiB           1           x_to_validate_adv_split,
   527   3210.7 MiB      0.0 MiB           1           x_to_validate_split,
   528   3210.8 MiB      0.1 MiB           1           y_to_train_0,
   529   3210.8 MiB      0.0 MiB           1           y_to_train_adversary_squeeze,
   530   3210.8 MiB      0.0 MiB           1           y_to_validate_0,
   531   3210.8 MiB      0.0 MiB           1           y_to_validate_adv_squeeze,
   532   3210.7 MiB      0.8 MiB           2       ) = setup_adversary_arrays(
   533   3209.9 MiB      0.0 MiB           1           mcWeights_val_adversary,
   534   3209.9 MiB      0.0 MiB           1           weights_to_train,  # type: ignore
   535   3209.9 MiB      0.0 MiB           1           weights_to_validate,  # type: ignore
   536   3209.9 MiB      0.0 MiB           1           weights_train_adversary,
   537   3209.9 MiB      0.0 MiB           1           weights_val_adversary,
   538   3209.9 MiB      0.0 MiB           1           x_to_adversary,
   539   3209.9 MiB      0.0 MiB           1           x_to_train,
   540   3209.9 MiB      0.0 MiB           1           x_to_validate,
   541   3209.9 MiB      0.0 MiB           1           x_to_validate_adv,
   542   3209.9 MiB      0.0 MiB           1           y_to_train,
   543   3209.9 MiB      0.0 MiB           1           y_to_train_adversary,  # type: ignore
   544   3209.9 MiB      0.0 MiB           1           y_to_validate,
   545   3209.9 MiB      0.0 MiB           1           y_to_validate_adv,
   546   3209.9 MiB      0.0 MiB           1           training_params,
   547                                             )
   548                                         
   549                                             # Summarize the two models
   550   3210.8 MiB      0.0 MiB           1       logging.debug("Summary of the original model:")
   551   3210.8 MiB      0.0 MiB           1       _enable_layers(original_model, "adversary", False)
   552   3210.9 MiB      0.0 MiB           1       original_model.summary(print_fn=logging.debug)
   553   3210.9 MiB      0.0 MiB           1       logging.debug("Summary of the discriminator model:")
   554   3210.9 MiB      0.0 MiB           1       _enable_layers(discriminator_model, "adversary", True)
   555   3210.9 MiB      0.0 MiB           1       discriminator_model.summary(print_fn=logging.debug)
   556                                         
   557                                             # Create the optimizers for the main training and the adversary training.
   558   3210.9 MiB      0.0 MiB           1       logging.debug("Creating the optimizers for the main training and the adversary training.")
   559   3210.9 MiB      0.0 MiB           1       assert training_params.lr_values is not None
   560   3210.9 MiB      0.0 MiB           2       optimizer = Nadam(
   561   3210.9 MiB      0.0 MiB           1           learning_rate=training_params.lr_values,
   562   3210.9 MiB      0.0 MiB           1           beta_1=0.9,
   563   3210.9 MiB      0.0 MiB           1           beta_2=0.999,
   564   3210.9 MiB      0.0 MiB           1           epsilon=1e-07,
   565                                             )
   566   3210.9 MiB      0.0 MiB           2       optimizer_adv = Nadam(
   567   3210.9 MiB      0.0 MiB           1           learning_rate=training_params.lr_values,
   568   3210.9 MiB      0.0 MiB           1           beta_1=0.9,
   569   3210.9 MiB      0.0 MiB           1           beta_2=0.999,
   570   3210.9 MiB      0.0 MiB           1           epsilon=1e-07,
   571                                             )
   572   3210.9 MiB      0.0 MiB           1       check_memory()
   573                                         
   574                                             # Compile the models
   575   3210.9 MiB      0.0 MiB           1       logging.debug("Compiling the models.")
   576   3210.9 MiB      0.0 MiB           1       _enable_layers(discriminator_model, "adversary", True)
   577   3210.9 MiB      0.0 MiB           2       discriminator_model.compile(
   578   3210.9 MiB      0.0 MiB           1           optimizer=optimizer_adv,
   579   3210.9 MiB      0.0 MiB           1           loss="binary_crossentropy",
   580   3210.9 MiB      0.0 MiB           1           metrics=[metrics.binary_accuracy],
   581                                             )
   582                                         
   583   3210.9 MiB      0.0 MiB           1       assert training_params.adversary_weight is not None
   584   3210.9 MiB      0.0 MiB           1       _enable_layers(original_model, "adversary", False)
   585   3210.9 MiB      0.0 MiB           2       original_model.compile(
   586   3210.9 MiB      0.0 MiB           1           optimizer=optimizer,
   587   3210.9 MiB      0.0 MiB           1           loss=["categorical_crossentropy", "binary_crossentropy"],
   588   3210.9 MiB      0.0 MiB           1           metrics=[metrics.categorical_accuracy, metrics.binary_accuracy],
   589   3210.9 MiB      0.0 MiB           1           loss_weights=[1, -training_params.adversary_weight],
   590                                             )
   591   3210.9 MiB      0.0 MiB           1       check_memory()
   592                                         
   593                                             # If this from a previous run, load the weights and our tracking history
   594   3210.9 MiB      0.0 MiB           1       keras_dir = dir_name / "keras"
   595   3210.9 MiB      0.0 MiB           1       epoch_h = HistoryTracker()
   596   3210.9 MiB      0.0 MiB           1       if (keras_dir / "final_weights_checkpoint.weights.h5").exists():
   597                                                 logging.info("Loading weights from previous run")
   598                                                 final_model.load_weights(keras_dir / "final_weights_checkpoint.weights.h5")
   599                                                 original_model.load_weights(keras_dir / "original_model_checkpoint.weights.h5")
   600                                                 discriminator_model.load_weights(keras_dir / "discriminator_checkpoint.weights.h5")
   601                                                 epoch_h.load(keras_dir / "history_checkpoint")
   602                                         
   603                                             # The number of epochs we are going to run, and how we are going to get started!
   604   3210.9 MiB      0.0 MiB           1       assert training_params.epochs is not None
   605   3210.9 MiB      0.0 MiB           1       first_epoch = len(epoch_h)
   606   3210.9 MiB      0.0 MiB           1       last_epoch = first_epoch + training_params.epochs
   607                                         
   608                                             # Train each epoch
   609   3210.9 MiB      0.0 MiB           1       logging.debug("Starting training")
   610  32489.4 MiB      0.0 MiB           4       for i_epoch in range(first_epoch, last_epoch):
   611  24905.4 MiB      0.0 MiB           3           logging.info(f"Training Epoch {i_epoch+1} of {last_epoch}")
   612                                         
   613  24905.4 MiB      0.0 MiB           3           last_loss = -1
   614  24905.4 MiB      0.0 MiB           3           last_main_output_loss = -1
   615  24905.4 MiB      0.0 MiB           3           last_adversary_loss = -1
   616  24905.4 MiB      0.0 MiB           3           last_main_cat_acc = -1
   617  24905.4 MiB      0.0 MiB           3           last_adv_bin_acc = -1
   618                                         
   619  24905.4 MiB      0.0 MiB           3           last_disc_loss = -1
   620  24905.4 MiB      0.0 MiB           3           last_disc_bin_acc = -1
   621                                         
   622                                                 # Training: the run main and adversary once each for every
   623                                                 # mini-batch
   624                                         
   625  32446.3 MiB  -2488.7 MiB          33           for i_batch in range(num_splits):
   626  31321.7 MiB  -5238.3 MiB          60               logging.debug(
   627  31321.7 MiB  -5238.3 MiB          60                   f"Running batch {i_batch+1} (of {num_splits} batches) of "
   628  31321.7 MiB  -2619.2 MiB          30                   f"epoch {i_epoch+1}"
   629                                                     )
   630                                         
   631                                                     # Train the adversary network
   632  31321.7 MiB  -2619.2 MiB          30               logging.debug("  -> Training adversary")
   633                                         
   634                                                     # training adversary twice with two different learning rates
   635  32329.7 MiB -10590.7 MiB          90               for _ in range(2):
   636  31940.7 MiB  -7166.2 MiB          60                   logging.debug("  Training adversary ")
   637                                         
   638  32329.7 MiB   5422.8 MiB         120                   adversary_hist = discriminator_model.train_on_batch(
   639  31940.7 MiB  -7166.2 MiB          60                       small_x_to_adversary_split[i_batch],
   640  31940.7 MiB  -7060.1 MiB          60                       small_y_to_train_adversary_0[i_batch],
   641  31940.7 MiB  -7060.1 MiB          60                       sample_weight=small_weights_train_adversary[i_batch],
   642                                                         )
   643  32329.7 MiB  -9579.9 MiB          60                   check_memory()
   644                                         
   645  32329.7 MiB  -7971.5 MiB          60                   last_disc_loss = adversary_hist[0]
   646  32329.7 MiB  -7971.5 MiB          60                   last_disc_bin_acc = adversary_hist[1]
   647  32329.7 MiB  -7971.5 MiB          60                   logging.debug(f"  Adversary Loss: {last_disc_loss:.4f}")
   648  32329.7 MiB  -7971.5 MiB          60                   logging.debug(f"  Adversary binary Accuracy: {last_disc_bin_acc:.4f}")
   649  32329.7 MiB  -7971.5 MiB          60                   del adversary_hist
   650  32329.7 MiB  -7971.0 MiB          60                   gc.collect()
   651                                         
   652  32329.7 MiB  -5198.9 MiB          30               logging.debug("  -> Training main network")
   653                                         
   654  32329.7 MiB  -4137.8 MiB          30               train_inputs = [*x_to_train_split[i_batch], *x_to_adversary_split[i_batch]]
   655  32329.7 MiB  -4137.8 MiB          30               train_outputs = [
   656  32329.7 MiB  -4137.8 MiB          30                   y_to_train_0[i_batch],
   657  32329.7 MiB  -4137.8 MiB          30                   y_to_train_adversary_squeeze[i_batch],
   658                                                     ]
   659  32329.7 MiB  -4137.8 MiB          30               train_weights = [
   660  32329.7 MiB  -4137.8 MiB          30                   weights_to_train_0[i_batch],
   661  32329.7 MiB  -4137.8 MiB          30                   weights_train_adversary_s[i_batch],
   662                                                     ]
   663                                         
   664  32446.3 MiB   1298.2 MiB          60               original_hist = original_model.train_on_batch(
   665  32329.7 MiB  -4922.9 MiB          30                   train_inputs, train_outputs, train_weights
   666                                                     )
   667  32446.3 MiB  -2594.9 MiB          30               check_memory()
   668                                         
   669                                                     # TODO: this is printed out at the end - we should do an average and a
   670                                                     # sigma or something
   671                                                     # not just the last mini-batch.
   672  32446.3 MiB  -2488.8 MiB          30               last_loss = original_hist[0]
   673  32446.3 MiB  -2488.8 MiB          30               last_main_output_loss = original_hist[1]
   674  32446.3 MiB  -2488.8 MiB          30               last_adversary_loss = original_hist[2]
   675  32446.3 MiB  -2488.8 MiB          30               last_adv_bin_acc = original_hist[3]
   676  32446.3 MiB  -2488.8 MiB          30               last_main_cat_acc = original_hist[4]
   677  32446.3 MiB  -2488.8 MiB          30               del original_hist
   678  32446.3 MiB  -2488.7 MiB          30               gc.collect()
   679                                         
   680  32446.3 MiB      0.0 MiB           3           logging.debug("  Info for last mini-batch of epoch")
   681  32446.3 MiB      0.0 MiB           3           logging.debug(f"  loss: {last_loss:.4f}")
   682  32446.3 MiB      0.0 MiB           3           logging.debug(f"  main_output_loss: {last_main_output_loss:.4f}")
   683  32446.3 MiB      0.0 MiB           3           logging.debug(f"  adversary_loss: {last_adversary_loss:.4f}")
   684  32446.3 MiB      0.0 MiB           3           logging.debug(f"  Main categorical accuracy: {last_main_cat_acc}")
   685  32446.3 MiB      0.0 MiB           3           logging.debug(f"  Adversary binary accuracy: {last_adv_bin_acc}")
   686                                         
   687                                                 # At the end of the epoch run testing.
   688  32446.3 MiB      0.0 MiB           3           logging.debug("End of Epoch Training")
   689                                         
   690                                                 # Do test on small batch
   691  32446.3 MiB  -1797.7 MiB           6           original_val_hist = original_model.test_on_batch(
   692  32446.3 MiB      0.0 MiB           3               [*(x_to_validate_split[0]), *(x_to_validate_adv_split[0])],
   693  32446.3 MiB      0.0 MiB           3               [y_to_validate_0[0], y_to_validate_adv_squeeze[0]],
   694  32446.3 MiB      0.0 MiB           3               [weights_to_validate_0[0], weights_val_adversary_split[0]],
   695                                                 )
   696  31844.5 MiB  -1797.7 MiB           3           val_last_loss = original_val_hist[0]
   697  31844.5 MiB      0.0 MiB           3           val_last_main_output_loss = original_val_hist[1]
   698  31844.5 MiB      0.0 MiB           3           val_last_adversary_loss = original_val_hist[2]
   699  31844.5 MiB      0.0 MiB           3           val_last_adv_bin_acc = original_val_hist[3]
   700  31844.5 MiB      0.0 MiB           3           val_last_main_cat_acc = original_val_hist[4]
   701  31844.5 MiB      0.0 MiB           3           logging.info(f"  loss on test dataset: {val_last_loss:.4f}")
   702  31844.5 MiB      0.0 MiB           3           logging.info(f"  main_output_loss on test dataset: {val_last_main_output_loss:.4f}")
   703  31844.5 MiB      0.0 MiB           3           logging.info(f"  adversary_loss on test dataset: {val_last_adversary_loss:.4f}")
   704  31844.5 MiB      0.0 MiB           3           logging.info(f"  Main categorical accuracy on test dataset: {val_last_main_cat_acc}")
   705  31844.5 MiB      0.0 MiB           3           logging.info(f"  Adversary binary accuracy on test dataset: {val_last_adv_bin_acc}")
   706  31844.5 MiB      0.0 MiB           3           del original_val_hist
   707  31844.5 MiB      0.0 MiB           3           gc.collect()
   708                                         
   709  32418.8 MiB   1725.8 MiB           6           adversary_val_hist = discriminator_model.test_on_batch(
   710  31844.5 MiB      0.0 MiB           3               small_x_val_adversary,
   711  31844.5 MiB      0.0 MiB           3               small_y_val_adversary[0],
   712  31844.5 MiB      0.0 MiB           3               small_weights_val_adversary,
   713                                                 )
   714  32418.8 MiB      0.0 MiB           3           check_memory()
   715  32418.8 MiB      0.0 MiB           3           val_last_disc_loss = adversary_val_hist[0]
   716  32418.8 MiB      0.0 MiB           3           val_last_disc_bin_acc = adversary_val_hist[1]
   717  32418.8 MiB      0.0 MiB           3           logging.debug(f"Val Adversary Loss: {val_last_disc_loss:.4f}")
   718  32418.8 MiB      0.0 MiB           3           logging.debug(f"Val Adversary binary Accuracy: {val_last_disc_bin_acc:.4f}")
   719                                         
   720                                                 # Calculate the K-S between our MC and Data multijet samples
   721  32473.6 MiB    176.9 MiB           6           ks_qcd, ks_sig, ks_bib = do_checkpoint_prediction_histogram(
   722  32418.8 MiB      0.0 MiB           3               final_model,
   723  32418.8 MiB      0.0 MiB           3               dir_name,
   724  32418.8 MiB      0.0 MiB           3               small_x_val_adversary,
   725  32418.8 MiB      0.0 MiB           3               small_y_val_adversary[0],
   726  32418.8 MiB      0.0 MiB           3               small_mcWeights_val_adversary,
   727  32418.8 MiB      0.0 MiB           3               f"{i_epoch:03d}_val",
   728  32418.8 MiB      0.0 MiB           3               high_mass,
   729  32418.8 MiB      0.0 MiB           3               low_mass,
   730                                                 )
   731                                         
   732                                                 # Every epoch save weights if KS test below some threshold (0.3 seems good)
   733                                                 #        if ks_bib < 0.3:
   734  32473.7 MiB      0.2 MiB           3           final_model.save_weights(keras_dir / f"final_model_weights_{i_epoch}.weights.h5")
   735                                         
   736                                                 # Save the checkpoints. If user hits ^C just right, we could get ourselves into
   737                                                 # an inconsistent state. But probably not likely enough to spend time
   738                                                 # protecting.
   739  32473.8 MiB      0.0 MiB           3           final_model.save_weights(keras_dir / "final_weights_checkpoint.weights.h5")
   740  32474.5 MiB      0.7 MiB           3           original_model.save_weights(keras_dir / "original_model_checkpoint.weights.h5")
   741  32474.5 MiB      0.0 MiB           3           discriminator_model.save_weights(keras_dir / "discriminator_checkpoint.weights.h5")
   742                                         
   743  32474.5 MiB      0.0 MiB           3           logging.info("Start clear session")
   744  32474.5 MiB      0.1 MiB           3           K.clear_session()
   745                                         
   746  32474.5 MiB      0.0 MiB           3           epoch_h.ks_qcd_hist.append(ks_qcd)
   747  32474.5 MiB      0.0 MiB           3           epoch_h.ks_sig_hist.append(ks_sig)
   748  32474.5 MiB      0.0 MiB           3           epoch_h.ks_bib_hist.append(ks_bib)
   749                                         
   750                                                 # Adding the train and test loss to a text function to save the loss
   751                                                 # Helpful to monitor training performance with large variations in loss
   752                                                 # making the graph hard to parse
   753                                         
   754  32474.5 MiB      0.0 MiB           6           with (dir_name / "train_loss.txt").open("a") as train_file:
   755  32474.5 MiB      0.0 MiB           3               train_file.write(str(last_main_output_loss) + "\n")
   756  32474.5 MiB      0.0 MiB           6           with (dir_name / "test_loss.txt").open("a") as test_file:
   757  32474.5 MiB      0.0 MiB           3               test_file.write(str(val_last_main_output_loss) + "\n")
   758                                         
   759                                                 # generating checkpoint plots of the model performance during training
   760  32478.5 MiB     21.8 MiB           6           checkpoint_pred_hist_main(
   761  32474.5 MiB      0.0 MiB           3               final_model,
   762  32474.5 MiB      0.0 MiB           3               dir_name,
   763  32474.5 MiB      0.0 MiB           3               x_to_test,
   764  32474.5 MiB      0.0 MiB           3               y_test,
   765  32474.5 MiB      0.0 MiB           3               mcWeights_test,
   766  32474.5 MiB      0.0 MiB           3               i_epoch,
   767  32474.5 MiB      0.0 MiB           3               high_mass,
   768  32474.5 MiB      0.0 MiB           3               low_mass,
   769                                                 )
   770                                         
   771                                                 # Append some lists with stats of latest epoch
   772  32478.5 MiB      0.0 MiB           3           epoch_h.adv_loss.append(last_disc_loss)
   773  32478.5 MiB      0.0 MiB           3           epoch_h.adv_acc.append(last_disc_bin_acc)
   774  32478.5 MiB      0.0 MiB           3           epoch_h.val_adv_loss.append(val_last_disc_loss)
   775  32478.5 MiB      0.0 MiB           3           epoch_h.val_adv_acc.append(val_last_disc_bin_acc)
   776  32478.5 MiB      0.0 MiB           3           epoch_h.original_lossf.append(last_main_output_loss)
   777  32478.5 MiB      0.0 MiB           3           epoch_h.original_acc.append(last_main_cat_acc)
   778  32478.5 MiB      0.0 MiB           3           epoch_h.val_original_lossf.append(val_last_main_output_loss)
   779  32478.5 MiB      0.0 MiB           3           epoch_h.val_original_acc.append(val_last_main_cat_acc)
   780  32478.5 MiB      0.0 MiB           3           epoch_h.original_adv_lossf.append(last_adversary_loss)
   781  32478.5 MiB      0.0 MiB           3           epoch_h.original_adv_acc.append(last_adv_bin_acc)
   782  32478.5 MiB      0.0 MiB           3           epoch_h.val_original_adv_lossf.append(val_last_adversary_loss)
   783  32478.5 MiB      0.0 MiB           3           epoch_h.val_original_adv_acc.append(val_last_adv_bin_acc)
   784                                         
   785                                                 # Save them
   786  32478.5 MiB      0.0 MiB           3           epoch_h.save(keras_dir / "history_checkpoint")
   787                                         
   788                                                 # And make run-time plots.
   789  32489.4 MiB     33.3 MiB           6           print_history_plots(
   790  32478.5 MiB      0.0 MiB           3               epoch_h.adv_loss,
   791  32478.5 MiB      0.0 MiB           3               epoch_h.adv_acc,
   792  32478.5 MiB      0.0 MiB           3               epoch_h.val_adv_loss,
   793  32478.5 MiB      0.0 MiB           3               epoch_h.val_adv_acc,
   794  32478.5 MiB      0.0 MiB           3               epoch_h.original_lossf,
   795  32478.5 MiB      0.0 MiB           3               epoch_h.original_acc,
   796  32478.5 MiB      0.0 MiB           3               epoch_h.val_original_lossf,
   797  32478.5 MiB      0.0 MiB           3               epoch_h.val_original_acc,
   798  32478.5 MiB      0.0 MiB           3               epoch_h.original_adv_lossf,
   799  32478.5 MiB      0.0 MiB           3               epoch_h.original_adv_acc,
   800  32478.5 MiB      0.0 MiB           3               epoch_h.val_original_adv_lossf,
   801  32478.5 MiB      0.0 MiB           3               epoch_h.val_original_adv_acc,
   802  32478.5 MiB      0.0 MiB           3               epoch_h.ks_qcd_hist,
   803  32478.5 MiB      0.0 MiB           3               epoch_h.ks_sig_hist,
   804  32478.5 MiB      0.0 MiB           3               epoch_h.ks_bib_hist,
   805  32478.5 MiB      0.0 MiB           3               dir_name,
   806                                                 )
   807  32489.4 MiB      0.0 MiB           3           logging.debug("Finished Epoch Validation")
   808  32489.4 MiB      0.0 MiB           1       logging.info("Finished training")
   809                                         
   810                                             # Evaluate Model with ROC curves
   811  32489.4 MiB      0.0 MiB           1       logging.debug("Evaluating model...")
   812                                             # TODO: improve doc on Z and mcWeights
   813  32512.0 MiB     22.6 MiB           2       roc_auc, SoverB = evaluate_model(
   814  32489.4 MiB      0.0 MiB           1           final_model,
   815  32489.4 MiB      0.0 MiB           1           discriminator_model,
   816  32489.4 MiB      0.0 MiB           1           dir_name,
   817  32489.4 MiB      0.0 MiB           1           x_to_test,
   818  32489.4 MiB      0.0 MiB           1           y_test,
   819  32489.4 MiB      0.0 MiB           1           weights_to_test,  # type: ignore
   820  32489.4 MiB      0.0 MiB           1           Z_test,
   821  32489.4 MiB      0.0 MiB           1           mcWeights_test,
   822  32489.4 MiB      0.0 MiB           1           x_to_test_adversary,
   823  32489.4 MiB      0.0 MiB           1           y_test_adversary,
   824  32489.4 MiB      0.0 MiB           1           weights_test_adversary,
   825  32489.4 MiB      0.0 MiB           1           None,
   826  32489.4 MiB      0.0 MiB           1           eval_object,
   827  32489.4 MiB      0.0 MiB           1           Z_test_adversary,
   828  32489.4 MiB      0.0 MiB           1           high_mass,
   829  32489.4 MiB      0.0 MiB           1           low_mass,
   830                                             )
   831  32512.0 MiB      0.0 MiB           1       check_memory()
   832  32512.0 MiB      0.0 MiB           1       logging.info(f"ROC area under curve: {roc_auc:.3f}")
   833  32512.0 MiB      0.0 MiB           1       logging.info("Max S over Root B: %.3f" % SoverB)
   834                                         
   835  32512.0 MiB      0.0 MiB           1       return roc_auc


Filename: /data/fye/CalRatioTrainer/cal_ratio_trainer/training/deepJet_train_keras.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    43    573.0 MiB    573.0 MiB           1   @profile
    44                                         def train_llp(
    45                                             training_params: TrainingConfig,
    46                                             cache: Path,
    47                                             continue_from: Optional[int],
    48                                             constit_input: ModelInput,
    49                                             track_input: ModelInput,
    50                                             MSeg_input: ModelInput,
    51                                             jet_input: JetInput,
    52                                             constit_input_adversary: ModelInput,
    53                                             track_input_adversary: ModelInput,
    54                                             MSeg_input_adversary: ModelInput,
    55                                             jet_input_adversary: JetInput,
    56                                             plt_model: bool = False,
    57                                         ) -> Tuple[float, Path]:
    58                                             """
    59                                             Takes in arguments to change architecture of network, does training, then runs
    60                                                 evaluate_training
    61                                         
    62                                             :param training_params: Class of many input parameters to training
    63                                             :param useGPU2: True to use GPU2
    64                                             :param constit_input: ModelInput object for constituents
    65                                             :param track_input: ModelInput object for tracks
    66                                             :param MSeg_input: ModelInput object for muon segments
    67                                             :param jet_input: ModelInput object for jets
    68                                             :param plt_model: True to save model architecture to disk
    69                                             :param skip_training: Skip training and evaluate based on directory of network given
    70                                             """
    71    694.5 MiB    121.5 MiB           1       logging.info(f"Num GPUs Available: {len(tf.config.list_physical_devices('GPU'))}")
    72    694.5 MiB      0.0 MiB           1       gpus = tf.config.experimental.list_physical_devices("GPU")
    73    694.5 MiB      0.0 MiB           1       if gpus:
    74    694.5 MiB      0.0 MiB           1           try:
    75    694.5 MiB      0.0 MiB           5               for gpu in gpus:
    76    694.5 MiB      0.0 MiB           4                   tf.config.experimental.set_memory_growth(gpu, True)
    77                                         
    78                                                 except RuntimeError as e:
    79                                                     logging.debug(e)
    80                                         
    81                                             # Fail early if we aren't going to be able to find what we need.
    82    694.5 MiB      0.0 MiB           1       assert training_params.main_training_file is not None
    83                                         
    84                                             # Setup directories for output.
    85    694.5 MiB      0.0 MiB           1       assert training_params.model_name is not None
    86                                         
    87    694.5 MiB      0.0 MiB           2       dir_name = create_directories(
    88    694.5 MiB      0.0 MiB           1           training_params.model_name, continue_from=continue_from
    89                                             )
    90    694.5 MiB      0.0 MiB           1       logging.debug(f"Main directory for output: {dir_name}")
    91                                         
    92                                             # Write a file with some details of architecture, will append final stats at end
    93                                             # of training
    94    694.5 MiB      0.0 MiB           1       logging.debug("Writing to file training details...")
    95    694.5 MiB      0.0 MiB           1       training_details_file = dir_name / "training_details.txt"
    96    694.5 MiB      0.0 MiB           2       with training_details_file.open("wt+") as f_out:
    97    694.5 MiB      0.0 MiB           1           print(f"Starting Training {datetime.now()}", file=f_out)
    98    694.5 MiB      0.0 MiB           1           print(f"ModeL: {training_details_file}", file=f_out)
    99    694.5 MiB      0.0 MiB           1           print(str(training_params), file=f_out)
   100                                         
   101                                             # Load dataset
   102    694.5 MiB      0.0 MiB           2       logging.info(
   103    694.5 MiB      0.0 MiB           1           f"Loading control region data file {training_params.cr_training_file}..."
   104                                             )
   105    694.5 MiB      0.0 MiB           1       assert training_params.cr_training_file is not None
   106   2113.5 MiB   1419.0 MiB           1       df_adversary = load_dataset(training_params.cr_training_file, cache)
   107   2113.5 MiB      0.0 MiB           1       assert training_params.frac_list is not None
   108   2113.0 MiB     -0.5 MiB           1       df_adversary = match_adversary_weights(df_adversary)
   109                                             # TODO: random seed isn't passed in here to `sample`, so it will
   110                                             # be different each run.
   111   1417.5 MiB   -695.5 MiB           1       df_adversary = df_adversary.sample(frac=training_params.frac_list)
   112                                         
   113   1417.5 MiB      0.0 MiB           2       logging.info(
   114   1417.5 MiB      0.0 MiB           1           f"Loading main training data from {training_params.main_training_file}..."
   115                                             )
   116   2127.4 MiB    709.9 MiB           1       df = load_dataset(training_params.main_training_file, cache)
   117   1740.5 MiB   -386.8 MiB           1       df = df.sample(frac=training_params.frac_list)
   118                                         
   119                                             # Extract labels
   120                                             # TODO: I do not trust how all the different weights come back, in particular,
   121                                             # how they used to be entangled due to various weird views vs copies of the
   122                                             # dataframes.
   123   2747.0 MiB      0.0 MiB           1       (
   124   2747.0 MiB      0.0 MiB           1           X,
   125   2747.0 MiB      0.0 MiB           1           X_adversary,
   126   2747.0 MiB      0.0 MiB           1           Y,
   127   2747.0 MiB      0.0 MiB           1           Y_adversary,
   128   2747.0 MiB      0.0 MiB           1           mcWeights,
   129   2747.0 MiB      0.0 MiB           1           mcWeights_adversary,
   130   2747.0 MiB      0.0 MiB           1           sig_weight,
   131   2747.0 MiB      0.0 MiB           1           weights,
   132   2747.0 MiB      0.0 MiB           1           weights_adversary,
   133   2747.0 MiB      0.0 MiB           1           Z,
   134   2747.0 MiB      0.0 MiB           1           Z_adversary,
   135   2747.0 MiB   1006.5 MiB           1       ) = prepare_training_datasets(df, df_adversary)
   136                                         
   137                                             # Save memory
   138   2049.0 MiB   -698.0 MiB           1       del df, df_adversary
   139   2049.0 MiB      0.0 MiB           1       gc.collect()
   140                                         
   141                                             # Split data into train/test datasets
   142   2049.0 MiB      0.0 MiB           1       random_state = 1
   143   2049.4 MiB      0.0 MiB           1       (
   144   2049.4 MiB      0.0 MiB           1           X_train,
   145   2049.4 MiB      0.0 MiB           1           X_test,
   146   2049.4 MiB      0.0 MiB           1           y_train,
   147   2049.4 MiB      0.0 MiB           1           y_test,
2024-09-13 11:14:50,631 - root - INFO - Estimated AUC 0.344 (0.000)
   148   2049.4 MiB      0.0 MiB           1           weights_train,
   149   2049.4 MiB      0.0 MiB           1           weights_test,
   150   2049.4 MiB      0.0 MiB           1           mcWeights_train,
   151   2049.4 MiB      0.0 MiB           1           mcWeights_test,
   152   2049.4 MiB      0.0 MiB           1           Z_train,
   153   2049.4 MiB      0.0 MiB           1           Z_test,
   154   2049.4 MiB      0.4 MiB           2       ) = train_test_split(
   155   2049.0 MiB      0.0 MiB           1           X,
   156   2049.0 MiB      0.0 MiB           1           Y,
   157   2049.0 MiB      0.0 MiB           1           weights,
   158   2049.0 MiB      0.0 MiB           1           mcWeights,
   159   2049.0 MiB      0.0 MiB           1           Z,
   160   2049.0 MiB      0.0 MiB           1           test_size=0.1,
   161   2049.0 MiB      0.0 MiB           1           random_state=random_state,
   162   2049.0 MiB      0.0 MiB           1           shuffle=False,
   163                                             )
   164   2750.7 MiB      0.0 MiB           1       (
   165   2750.7 MiB      0.0 MiB           1           X_train_adversary,
   166   2750.7 MiB      0.0 MiB           1           X_test_adversary,
   167   2750.7 MiB      0.0 MiB           1           y_train_adversary,
   168   2750.7 MiB      0.0 MiB           1           y_test_adversary,
   169   2750.7 MiB      0.0 MiB           1           weights_train_adversary,
   170   2750.7 MiB      0.0 MiB           1           weights_test_adversary,
   171   2750.7 MiB      0.0 MiB           1           mcWeights_train_adversary,
   172   2750.7 MiB      0.0 MiB           1           mcWeights_test_adversary,
   173   2750.7 MiB      0.0 MiB           1           Z_train_adversary,
   174   2750.7 MiB      0.0 MiB           1           Z_test_adversary,
   175   2750.7 MiB    701.3 MiB           2       ) = train_test_split(
   176   2049.4 MiB      0.0 MiB           1           X_adversary,
   177   2049.4 MiB      0.0 MiB           1           Y_adversary,
   178   2049.4 MiB      0.0 MiB           1           weights_adversary,
   179   2049.4 MiB      0.0 MiB           1           mcWeights_adversary,
   180   2049.4 MiB      0.0 MiB           1           Z_adversary,
   181   2049.4 MiB      0.0 MiB           1           test_size=0.1,
   182   2049.4 MiB      0.0 MiB           1           random_state=random_state,
   183   2049.4 MiB      0.0 MiB           1           shuffle=False,
   184                                             )
   185                                             # Delete variables to save memory
   186   2062.8 MiB   -687.9 MiB           1       del X, X_adversary, Y, Y_adversary, Z, Z_adversary
   187   2062.8 MiB      0.0 MiB           1       gc.collect()
   188                                         
   189   2062.8 MiB      0.0 MiB           1       eval_object = evaluationObject()
   190   2062.8 MiB      0.0 MiB           1       eval_object.fillObject_params(training_params)
   191                                         
   192                                             # Call method that prepares data, builds model architecture, trains model,
   193                                             # and evaluates model
   194  32512.0 MiB  30449.2 MiB          33       roc_auc = build_train_evaluate_model(
   195   2062.8 MiB      0.0 MiB           1           constit_input,
   196   2062.8 MiB      0.0 MiB           1           track_input,
   197   2062.8 MiB      0.0 MiB           1           MSeg_input,
   198   2062.8 MiB      0.0 MiB           1           jet_input,
   199   2062.8 MiB      0.0 MiB           1           X_train,
   200   2062.8 MiB      0.0 MiB           1           X_test,
   201   2062.8 MiB      0.0 MiB           1           y_train,
   202   2062.8 MiB      0.0 MiB           1           y_test,
   203   2062.8 MiB      0.0 MiB           1           mcWeights_train,
   204   2062.8 MiB      0.0 MiB           1           mcWeights_test,
   205   2062.8 MiB      0.0 MiB           1           weights_train,
   206   2062.8 MiB      0.0 MiB           1           weights_test,
   207   2062.8 MiB      0.0 MiB           1           Z_test,
   208   2062.8 MiB      0.0 MiB           1           Z_train,
   209   2062.8 MiB      0.0 MiB           1           constit_input_adversary,
   210   2062.8 MiB      0.0 MiB           1           track_input_adversary,
   211   2062.8 MiB      0.0 MiB           1           MSeg_input_adversary,
   212   2062.8 MiB      0.0 MiB           1           jet_input_adversary,
   213   2062.8 MiB      0.0 MiB           1           X_train_adversary,
   214   2062.8 MiB      0.0 MiB           1           X_test_adversary,
   215   2062.8 MiB      0.0 MiB           1           y_train_adversary,
   216   2062.8 MiB      0.0 MiB           1           y_test_adversary,
   217   2062.8 MiB      0.0 MiB           1           mcWeights_train_adversary,
   218   2062.8 MiB      0.0 MiB           1           mcWeights_test_adversary,
   219   2062.8 MiB      0.0 MiB           1           weights_train_adversary,
   220   2062.8 MiB      0.0 MiB           1           weights_test_adversary,
   221   2062.8 MiB      0.0 MiB           1           Z_test_adversary,
   222   2062.8 MiB      0.0 MiB           1           Z_train_adversary,
   223   2062.8 MiB      0.0 MiB           1           plt_model,
   224   2062.8 MiB      0.0 MiB           1           dir_name,
   225   2062.8 MiB      0.0 MiB           1           eval_object,
   226   2062.8 MiB      0.0 MiB           1           training_params,
   227                                             )
   228                                         
   229  32512.0 MiB      0.0 MiB           1       return roc_auc, dir_name


Estimated AUC 0.344 (0.000)
